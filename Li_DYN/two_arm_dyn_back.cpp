#include "two_arm_dyn.h"
#include <ctime>

extern state_type r_d_gold, r_d_green;
double integral_err1, integral_err2=0.0;
extern double V[4], Load[4];
extern int motor_id;

void write_sys( const state_type &x )
{
	cout << x[0] << '\t' << x[1]  << '\t' << x[2] << '\t' << x[3]  << '\t' << x[4]<< '\t' << x[5]
	<< '\t' << x[6]<< '\t' << x[7]  <<endl;
}


void motor_40(const motor_state &r, motor_state &drdt, const double t)
{
	double Rm = 1.16;  
	double La = 0.329*1e-3; 
	double Kv = 60.3/1000.0;  
	double Kt = 60.3/1000.0; 
	double bm = 1.0/(3.04*M_PI/30*1000); 
	double Jm = 138.0*1e-7;

	drdt[0] = -Rm/La*r[0]-Kv/La*r[2]+V[motor_id]/La;
	drdt[1] = r[2];
	drdt[2] = Kt/Jm*r[0]-bm/Jm*r[2]-1/Jm*Load[motor_id];
}

void motor_30(const motor_state &r, motor_state &drdt, const double t)
{
	double Rm = 2.52;  
	double La = 0.513*1e-3; 
	double Kv = 53.8/1000.0;  
	double Kt = 53.8/1000.0; 
	double bm = 1.0/(8.33*M_PI/30*1000); 
	double Jm = 34.5*1e-7;

	drdt[0] = -Rm/La*r[0]-Kv/La*r[2]+V[motor_id]/La;
	drdt[1] = r[2];
	drdt[2] = Kt/Jm*r[0]-bm/Jm*r[2]-1/Jm*Load[motor_id];
}

Array2D<double> PID_control_gold(const state_type &r,const double t)
{
	Array2D<double> torque(4,1);

	integral_err1 = integral_err1+(r_d_gold[2]-r[2])*0.00001;

	torque[0][0] = 200.0*(r_d_gold[0]-r[0])-10.0*r[4];
	torque[1][0] = 100.0*(r_d_gold[1]-r[1])-5.0*r[5];
	torque[2][0] = 100.0*(r_d_gold[2]-r[2])-10.0*r[6]+400.0*integral_err1;
	torque[3][0] = 0.009*(r_d_gold[3]-r[3])-0.00001*r[7];

	//last_time_step=t;
	return torque;
}


Array2D<double> PID_control_green(const state_type &r,const double t)
{
	Array2D<double> torque(4,1);

	integral_err2 = integral_err2+(r_d_green[2]-r[2])*0.00001;

	torque[0][0] = 200.0*(r_d_green[0]-r[0])-10.0*r[4];
	torque[1][0] = 100.0*(r_d_green[1]-r[1])-5.0*r[5];
	torque[2][0] = 100.0*(r_d_green[2]-r[2])-10.0*r[6]+400.0*integral_err2;
	torque[3][0] = 0.009*(r_d_green[3]-r[3])-0.00001*r[7];

	//last_time_step=t;
	return torque;
}

//new here



void sys_dyn_gold( const state_type &r , state_type &drdt , double t )
{
	double r_dot[8]={0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0};
	double t1  =r[0];
	double t2  =r[1];
	double t3  =r[2];
	double t4  =r[3];
	double t1_d=r[4];
	double t2_d=r[5];
	double t3_d=r[6];
	double t4_d=r[7];

	drdt[0] = r[4];
	drdt[1] = r[5];
	drdt[2] = r[6];
	drdt[3] = r[7];

	double s1=sin(r[0]);
	double s2=sin(r[1]);
	double s4=sin(r[3]);
	double c1=cos(r[0]);
	double c2=cos(r[1]);
	double c4=cos(r[3]);
	
	double r1_1 =0.001326678647*pow(c2,4)*pow(c4,2)*pow(t3,2) - 0.000706128196*pow(c2,4)*pow(c4,2)*t3 + 0.00009395964692*pow(c2,4)*pow(c4,2) + 0.001326678647*pow(c2,4)*pow(s4,2)*pow(t3,2) - 0.000706128196*pow(c2,4)*pow(s4,2)*t3 + 0.00009395964692*pow(c2,4)*pow(s4,2) + 0.007470314739*pow(c2,4)*pow(t3,2) - 0.0002260385019*pow(c2,4)*t3 + 0.0005932425944*pow(c2,4) - 0.007736652973*pow(c2,3)*pow(c4,2)*pow(t3,2) + 0.004117777963*pow(c2,3)*pow(c4,2)*t3 - 0.0005479144343*pow(c2,3)*pow(c4,2) - 0.007736652973*pow(c2,3)*pow(s4,2)*pow(t3,2) + 0.004117777963*pow(c2,3)*pow(s4,2)*t3 - 0.0005479144343*pow(c2,3)*pow(s4,2) - 0.04356385237*pow(c2,3)*pow(t3,2) - 0.0003614612976*pow(c2,3)*t3 - 0.005636457195*pow(c2,3) + 0.002653357295*pow(c2,2)*pow(c4,2)*pow(s2,2)*pow(t3,2) - 0.001412256392*pow(c2,2)*pow(c4,2)*pow(s2,2)*t3 + 0.0001879192938*pow(c2,2)*pow(c4,2)*pow(s2,2) + 9.84269479e-11*pow(c2,2)*pow(c4,2)*s2*t3 - 2.619363477e-11*pow(c2,2)*pow(c4,2)*s2 + 0.01127925729*pow(c2,2)*pow(c4,2)*pow(t3,2) - 0.006003192991*pow(c2,2)*pow(c4,2)*t3 + 0.0009538646781*pow(c2,2)*pow(c4,2) - 7.141006928e-13*pow(c2,2)*c4*s4 + 2.656072593e-12*pow(c2,2)*c4 + 0.002653357295*pow(c2,2)*pow(s2,2)*pow(s4,2)*pow(t3,2) - 0.001412256392*pow(c2,2)*pow(s2,2)*pow(s4,2)*t3 + 0.0001879192938*pow(c2,2)*pow(s2,2)*pow(s4,2) + 0.01494062948*pow(c2,2)*pow(s2,2)*pow(t3,2) - 0.0004520770037*pow(c2,2)*pow(s2,2)*t3 + 0.001186485189*pow(c2,2)*pow(s2,2) + 9.84269479e-11*pow(c2,2)*s2*pow(s4,2)*t3 - 2.619363477e-11*pow(c2,2)*s2*pow(s4,2) + 0.000008321632637*pow(c2,2)*s2*t3 - 0.0001346320582*pow(c2,2)*s2 + 0.01127925729*pow(c2,2)*pow(s4,2)*pow(t3,2) - 0.006003192991*pow(c2,2)*pow(s4,2)*t3 + 0.0009538643244*pow(c2,2)*pow(s4,2) - 4.672253255e-11*pow(c2,2)*s4 + 0.06351168926*pow(c2,2)*pow(t3,2) + 0.002975699307*pow(c2,2)*t3 + 0.01590915902*pow(c2,2) - 0.007736652973*c2*pow(c4,2)*pow(s2,2)*pow(t3,2) + 0.004117777963*c2*pow(c4,2)*pow(s2,2)*t3 - 0.0005479144343*c2*pow(c4,2)*pow(s2,2) + 0.0000000004701665536*c2*pow(c4,2)*s2*t3 - 0.000000000126281835*c2*pow(c4,2)*s2 - 0.0001063793422*c2*pow(c4,2) - 0.000000001148839953*c2*c4*s2*s4 - 7.58899727e-11*c2*c4*s2 + 4.898149856e-13*c2*c4*s4 - 3.548897333e-13*c2*c4 - 0.007736652973*c2*pow(s2,2)*pow(s4,2)*pow(t3,2) + 0.004117777963*c2*pow(s2,2)*pow(s4,2)*t3 - 0.0005479144343*c2*pow(s2,2)*pow(s4,2) - 0.04356385237*c2*pow(s2,2)*pow(t3,2) - 0.0003614612976*c2*pow(s2,2)*t3 - 0.005636457195*c2*pow(s2,2) + 0.0000000004701665536*c2*s2*pow(s4,2)*t3 - 0.0000000001239620514*c2*s2*pow(s4,2) - 4.314177163e-12*c2*s2*s4 + 0.00003975083471*c2*s2*t3 - 0.0006177779047*c2*s2 - 0.0001063790997*c2*pow(s4,2) + 6.242806612e-12*c2*s4 - 0.001703470331*c2 + 0.001326678647*pow(c4,2)*pow(s2,4)*pow(t3,2) - 0.000706128196*pow(c4,2)*pow(s2,4)*t3 + 0.00009395964692*pow(c4,2)*pow(s2,4) + 9.84269479e-11*pow(c4,2)*pow(s2,3)*t3 - 2.619363477e-11*pow(c4,2)*pow(s2,3) + 0.02975750711*pow(c4,2)*pow(s2,2)*pow(t3,2) - 0.01583829001*pow(c4,2)*pow(s2,2)*t3 + 0.002516629606*pow(c4,2)*pow(s2,2) + 3.977957085e-13*pow(c4,2)*s2 + 0.0000182418938*pow(c4,2) + 1.883976568e-12*c4*pow(s2,2)*s4 + 0.0000000003940053768*c4*s2*s4 - 1.588717515e-11*c4*s2 - 8.399330883e-14*c4*s4 - 1.906974355e-13*c4 + 0.001326678647*pow(s2,4)*pow(s4,2)*pow(t3,2) - 0.000706128196*pow(s2,4)*pow(s4,2)*t3 + 0.00009395964692*pow(s2,4)*pow(s4,2) + 0.007470314739*pow(s2,4)*pow(t3,2) - 0.0002260385019*pow(s2,4)*t3 + 0.0005932425944*pow(s2,4) + 9.84269479e-11*pow(s2,3)*pow(s4,2)*t3 - 2.619363477e-11*pow(s2,3)*pow(s4,2) + 0.000008321632637*pow(s2,3)*t3 - 0.0001346320582*pow(s2,3) + 0.02975750711*pow(s2,2)*pow(s4,2)*pow(t3,2) - 0.01583829001*pow(s2,2)*pow(s4,2)*t3 + 0.002516630539*pow(s2,2)*pow(s4,2) + 0.1675597511*pow(s2,2)*pow(t3,2) - 0.0001726108844*pow(s2,2)*t3 + 0.02909245143*pow(s2,2) - 3.977957085e-13*s2*pow(s4,2) - 9.031507689e-13*s2*s4 - 0.00005881111971*s2 + 0.0000182418522*pow(s4,2) + 3.354526911e-12*s4 + 0.004626930017;
	double r1_2 =0.005125892675*pow(c2,2)*pow(c4,2)*pow(t3,2) - 0.002728269845*pow(c2,2)*pow(c4,2)*t3 + 0.0003630321984*pow(c2,2)*pow(c4,2) + 0.005125892675*pow(c2,2)*pow(s4,2)*pow(t3,2) - 0.002728269845*pow(c2,2)*pow(s4,2)*t3 + 0.0003630321984*pow(c2,2)*pow(s4,2) + 0.02886307975*pow(c2,2)*pow(t3,2) - 0.0008733457067*pow(c2,2)*t3 + 0.002292113373*pow(c2,2) - 0.01494606583*c2*pow(c4,2)*pow(t3,2) + 0.007954936163*c2*pow(c4,2)*t3 - 0.001263998513*c2*pow(c4,2) + 9.462498894e-13*c2*c4*s4 - 6.855943178e-13*c2*c4 - 0.01494606583*c2*pow(s4,2)*pow(t3,2) + 0.007954936163*c2*pow(s4,2)*t3 - 0.001263998045*c2*pow(s4,2) + 1.206017627e-11*c2*s4 - 0.08415890019*c2*pow(t3,2) - 0.0006982896052*c2*t3 - 0.01417965112*c2 + 0.005125892675*pow(c4,2)*pow(s2,2)*pow(t3,2) - 0.002728269845*pow(c4,2)*pow(s2,2)*t3 + 0.0003630321984*pow(c4,2)*pow(s2,2) + 0.000000000190146262*pow(c4,2)*s2*t3 - 4.983373431e-11*pow(c4,2)*s2 + 0.00007048126535*pow(c4,2) + 0.0000000007611599382*c4*s2*s4 - 3.069166558e-11*c4*s2 - 3.245252249e-13*c4*s4 - 7.367983117e-13*c4 + 0.005125892675*pow(s2,2)*pow(s4,2)*pow(t3,2) - 0.002728269845*pow(s2,2)*pow(s4,2)*t3 + 0.0003630321984*pow(s2,2)*pow(s4,2) + 0.02886307975*pow(s2,2)*pow(t3,2) - 0.0008733457067*pow(s2,2)*t3 + 0.002292113373*pow(s2,2) + 0.000000000190146262*s2*pow(s4,2)*t3 - 5.137069891e-11*s2*pow(s4,2) - 1.744753215e-12*s2*s4 + 0.00001607615976*s2*t3 - 0.000373703523*s2 + 0.00007048110464*pow(s4,2) + 1.296089671e-11*s4 + 0.001424956624;
	double r1_3 =- 0.000005513534141*pow(c2,2) + 0.00001607634991*c2 - 0.000005513534141*pow(s2,2) - 0.003244935615*s2;
	double r1_4 =0.000000303353443*c2 - 5.983794116e-13*c4 + 1.052599296e-11*s4 + 1.744753284e-12*c2*c4 - 3.069166558e-11*c2*s4 - 4.985152849e-11*c4*s2 - 2.8339491e-12*s2*s4 + 0.00000006350548183;
	double e1_left =0.1078534345*c1*c2 - 0.0216746394*s1 - 0.9140222856*c1 + 0.003039018772*c1*s2 + 0.01174186687*c2*s1 - 1.23376453*c1*t3 - 0.4167136714*s1*s2 - 0.000373703523*c2*pow(t2_d,2) + 1.052599296e-11*c4*pow(t4_d,2) + 0.01417965112*s2*pow(t2_d,2) + 5.983794116e-13*s4*pow(t4_d,2) - 1.744753215e-12*c2*s4*pow(t2_d,2) + 6.855943178e-13*c4*s2*pow(t2_d,2) - 1.744753284e-12*c2*s4*pow(t4_d,2) - 2.8339491e-12*c4*s2*pow(t4_d,2) + 0.00001607615976*c2*t3*pow(t2_d,2) - 0.0006177779047*pow(c2,2)*t1_d*t2_d + 0.002975699307*pow(c2,2)*t1_d*t3_d - 0.0001346320582*pow(c2,3)*t1_d*t2_d - 0.0008733457067*pow(c2,2)*t2_d*t3_d - 0.0003614612976*pow(c2,3)*t1_d*t3_d - 0.0002260385019*pow(c2,4)*t1_d*t3_d - 8.399330883e-14*pow(c4,2)*t1_d*t4_d - 3.245252249e-13*pow(c4,2)*t2_d*t4_d - 1.206017627e-11*s2*s4*pow(t2_d,2) + 4.985152849e-11*s2*s4*pow(t4_d,2) + 0.0006982896052*s2*t3*pow(t2_d,2) + 0.0006177779047*pow(s2,2)*t1_d*t2_d - 0.0001726108844*pow(s2,2)*t1_d*t3_d + 0.005636457195*pow(s2,3)*t1_d*t2_d - 0.0008733457067*pow(s2,2)*t2_d*t3_d + 0.000008321632637*pow(s2,3)*t1_d*t3_d - 0.0002260385019*pow(s2,4)*t1_d*t3_d + 8.399330883e-14*pow(s4,2)*t1_d*t4_d + 3.245252249e-13*pow(s4,2)*t2_d*t4_d - 4.983373431e-11*c2*pow(c4,2)*pow(t2_d,2) - 5.137069891e-11*c2*pow(s4,2)*pow(t2_d,2) + 0.001263998513*pow(c4,2)*s2*pow(t2_d,2) + 0.001263998045*s2*pow(s4,2)*pow(t2_d,2) + 0.08415890019*s2*pow(t3,2)*pow(t2_d,2) + 0.4231310524*c1*c2*t3 - 0.00005881111971*c2*t1_d*t2_d - 0.00394322522*c2*t2_d*t3_d + 3.354526911e-12*c4*t1_d*t4_d + 1.296089671e-11*c4*t2_d*t4_d - 1.634852846*s1*s2*t3 + 0.001703470331*s2*t1_d*t2_d - 0.000000000190146262*s2*t2_d*t3_d - 0.000000303353443*s2*t2_d*t4_d + 1.906974355e-13*s4*t1_d*t4_d + 7.367983117e-13*s4*t2_d*t4_d - 3.069166558e-11*c2*c4*pow(t2_d,2) - 3.069166558e-11*c2*c4*pow(t4_d,2) - 1.588717515e-11*c2*c4*t1_d*t2_d + 6.242806612e-12*c2*c4*t1_d*t4_d - 3.779135222e-11*c2*c4*t2_d*t4_d + 0.02636658481*c2*s2*t1_d*t2_d + 0.00003975083471*c2*s2*t1_d*t3_d - 9.031507689e-13*c2*s4*t1_d*t2_d + 3.548897333e-13*c4*s2*t1_d*t2_d + 3.548897333e-13*c2*s4*t1_d*t4_d - 9.031507689e-13*c4*s2*t1_d*t4_d - 2.148354782e-12*c2*s4*t2_d*t4_d - 3.489506499e-12*c4*s2*t2_d*t4_d - 8.319299225e-11*c4*s4*t1_d*t4_d - 0.0000000003214330391*c4*s4*t2_d*t4_d - 0.1683178004*c2*t3*t2_d*t3_d - 6.242806612e-12*s2*s4*t1_d*t2_d + 1.588717515e-11*s2*s4*t1_d*t4_d + 6.138333115e-11*s2*s4*t2_d*t4_d + 0.01494606583*pow(c4,2)*s2*pow(t3,2)*pow(t2_d,2) + 0.01494606583*s2*pow(s4,2)*pow(t3,2)*pow(t2_d,2) + 0.0000000007611599382*c2*c4*s4*pow(t2_d,2) + 3.977957085e-13*c2*pow(c4,2)*t1_d*t2_d - 7.58899727e-11*pow(c2,2)*c4*t1_d*t2_d + 4.898149856e-13*c2*pow(c4,2)*t1_d*t4_d + 0.007954936163*c2*pow(c4,2)*t2_d*t3_d - 4.672253255e-11*pow(c2,2)*c4*t1_d*t4_d + 9.462498894e-13*c2*pow(c4,2)*t2_d*t4_d - 9.462498894e-13*c4*s2*s4*pow(t2_d,2) - 0.0001346320582*c2*pow(s2,2)*t1_d*t2_d + 0.005636457195*pow(c2,2)*s2*t1_d*t2_d - 0.0003614612976*c2*pow(s2,2)*t1_d*t3_d + 0.000008321632637*pow(c2,2)*s2*t1_d*t3_d - 3.977957085e-13*c2*pow(s4,2)*t1_d*t2_d + 7.58899727e-11*c4*pow(s2,2)*t1_d*t2_d - 4.314177163e-12*pow(c2,2)*s4*t1_d*t2_d + 0.0001063793422*pow(c4,2)*s2*t1_d*t2_d - 4.898149856e-13*c2*pow(s4,2)*t1_d*t4_d + 0.007954936163*c2*pow(s4,2)*t2_d*t3_d - 2.656072593e-12*pow(c2,2)*s4*t1_d*t4_d + 0.0000000003940053768*pow(c4,2)*s2*t1_d*t4_d + 0.000000000190146262*pow(c4,2)*s2*t2_d*t3_d - 9.462498894e-13*c2*pow(s4,2)*t2_d*t4_d + 0.0000000007611599382*pow(c4,2)*s2*t2_d*t4_d + 0.00003975083471*pow(c2,2)*t3*t1_d*t2_d + 0.1270233785*pow(c2,2)*t3*t1_d*t3_d + 0.000008321632637*pow(c2,3)*t3*t1_d*t2_d + 0.05772615949*pow(c2,2)*t3*t2_d*t3_d - 0.08712770474*pow(c2,3)*t3*t1_d*t3_d + 0.01494062948*pow(c2,4)*t3*t1_d*t3_d + 0.0001063790997*s2*pow(s4,2)*t1_d*t2_d + 4.314177163e-12*pow(s2,2)*s4*t1_d*t2_d - 0.0000000003940053768*s2*pow(s4,2)*t1_d*t4_d + 0.000000000190146262*s2*pow(s4,2)*t2_d*t3_d - 0.0000000007611599382*s2*pow(s4,2)*t2_d*t4_d - 0.00003975083471*pow(s2,2)*t3*t1_d*t2_d + 0.3351195023*pow(s2,2)*t3*t1_d*t3_d + 0.0003614612976*pow(s2,3)*t3*t1_d*t2_d + 0.05772615949*pow(s2,2)*t3*t2_d*t3_d + 0.01494062948*pow(s2,4)*t3*t1_d*t3_d + 0.000000000190146262*c2*pow(c4,2)*t3*pow(t2_d,2) - 0.000000000126281835*pow(c2,2)*pow(c4,2)*t1_d*t2_d - 0.006003192991*pow(c2,2)*pow(c4,2)*t1_d*t3_d - 2.619363477e-11*pow(c2,3)*pow(c4,2)*t1_d*t2_d - 7.141006928e-13*pow(c2,2)*pow(c4,2)*t1_d*t4_d - 0.002728269845*pow(c2,2)*pow(c4,2)*t2_d*t3_d + 0.004117777963*pow(c2,3)*pow(c4,2)*t1_d*t3_d - 0.000706128196*pow(c2,4)*pow(c4,2)*t1_d*t3_d + 0.000000000190146262*c2*pow(s4,2)*t3*pow(t2_d,2) - 0.007954936163*pow(c4,2)*s2*t3*pow(t2_d,2) - 0.0004520770037*pow(c2,2)*pow(s2,2)*t1_d*t3_d - 0.0000000001239620514*pow(c2,2)*pow(s4,2)*t1_d*t2_d + 0.000000000126281835*pow(c4,2)*pow(s2,2)*t1_d*t2_d - 0.006003192991*pow(c2,2)*pow(s4,2)*t1_d*t3_d - 2.619363477e-11*pow(c2,3)*pow(s4,2)*t1_d*t2_d - 0.01583829001*pow(c4,2)*pow(s2,2)*t1_d*t3_d + 0.0005479144343*pow(c4,2)*pow(s2,3)*t1_d*t2_d + 7.141006928e-13*pow(c2,2)*pow(s4,2)*t1_d*t4_d - 0.002728269845*pow(c2,2)*pow(s4,2)*t2_d*t3_d + 0.004117777963*pow(c2,3)*pow(s4,2)*t1_d*t3_d + 1.883976568e-12*pow(c4,2)*pow(s2,2)*t1_d*t4_d - 0.002728269845*pow(c4,2)*pow(s2,2)*t2_d*t3_d + 9.84269479e-11*pow(c4,2)*pow(s2,3)*t1_d*t3_d - 0.000706128196*pow(c2,4)*pow(s4,2)*t1_d*t3_d - 0.000706128196*pow(c4,2)*pow(s2,4)*t1_d*t3_d - 0.007954936163*s2*pow(s4,2)*t3*pow(t2_d,2) + 0.0000000001239620514*pow(s2,2)*pow(s4,2)*t1_d*t2_d - 0.01583829001*pow(s2,2)*pow(s4,2)*t1_d*t3_d + 0.0005479144343*pow(s2,3)*pow(s4,2)*t1_d*t2_d - 1.883976568e-12*pow(s2,2)*pow(s4,2)*t1_d*t4_d - 0.002728269845*pow(s2,2)*pow(s4,2)*t2_d*t3_d + 9.84269479e-11*pow(s2,3)*pow(s4,2)*t1_d*t3_d - 0.000706128196*pow(s2,4)*pow(s4,2)*t1_d*t3_d + 0.04356385237*pow(s2,3)*pow(t3,2)*t1_d*t2_d - 2.619363477e-11*c2*pow(c4,2)*pow(s2,2)*t1_d*t2_d + 0.0005479144343*pow(c2,2)*pow(c4,2)*s2*t1_d*t2_d + 0.004117777963*c2*pow(c4,2)*pow(s2,2)*t1_d*t3_d + 9.84269479e-11*pow(c2,2)*pow(c4,2)*s2*t1_d*t3_d + 0.0000000004701665536*pow(c2,2)*pow(c4,2)*t3*t1_d*t2_d + 0.02255851458*pow(c2,2)*pow(c4,2)*t3*t1_d*t3_d + 9.84269479e-11*pow(c2,3)*pow(c4,2)*t3*t1_d*t2_d + 0.01025178535*pow(c2,2)*pow(c4,2)*t3*t2_d*t3_d - 0.01547330595*pow(c2,3)*pow(c4,2)*t3*t1_d*t3_d + 0.002653357295*pow(c2,4)*pow(c4,2)*t3*t1_d*t3_d - 2.619363477e-11*c2*pow(s2,2)*pow(s4,2)*t1_d*t2_d + 0.0005479144343*pow(c2,2)*s2*pow(s4,2)*t1_d*t2_d + 0.004117777963*c2*pow(s2,2)*pow(s4,2)*t1_d*t3_d + 9.84269479e-11*pow(c2,2)*s2*pow(s4,2)*t1_d*t3_d + 0.04356385237*pow(c2,2)*s2*pow(t3,2)*t1_d*t2_d + 0.02988125896*pow(c2,2)*pow(s2,2)*t3*t1_d*t3_d + 0.0000000004701665536*pow(c2,2)*pow(s4,2)*t3*t1_d*t2_d - 0.0000000004701665536*pow(c4,2)*pow(s2,2)*t3*t1_d*t2_d + 0.02255851458*pow(c2,2)*pow(s4,2)*t3*t1_d*t3_d + 9.84269479e-11*pow(c2,3)*pow(s4,2)*t3*t1_d*t2_d + 0.05951501423*pow(c4,2)*pow(s2,2)*t3*t1_d*t3_d - 0.004117777963*pow(c4,2)*pow(s2,3)*t3*t1_d*t2_d + 0.01025178535*pow(c2,2)*pow(s4,2)*t3*t2_d*t3_d - 0.01547330595*pow(c2,3)*pow(s4,2)*t3*t1_d*t3_d + 0.01025178535*pow(c4,2)*pow(s2,2)*t3*t2_d*t3_d + 0.002653357295*pow(c2,4)*pow(s4,2)*t3*t1_d*t3_d + 0.002653357295*pow(c4,2)*pow(s2,4)*t3*t1_d*t3_d - 0.0000000004701665536*pow(s2,2)*pow(s4,2)*t3*t1_d*t2_d + 0.05951501423*pow(s2,2)*pow(s4,2)*t3*t1_d*t3_d - 0.004117777963*pow(s2,3)*pow(s4,2)*t3*t1_d*t2_d + 0.01025178535*pow(s2,2)*pow(s4,2)*t3*t2_d*t3_d + 0.002653357295*pow(s2,4)*pow(s4,2)*t3*t1_d*t3_d - 5.312145629e-12*c2*c4*s2*t1_d*t2_d - 4.314177163e-12*c2*c4*s2*t1_d*t4_d + 0.0000000003940053768*c2*c4*s4*t1_d*t2_d + 0.0000000004851478632*c2*c4*s4*t1_d*t4_d + 0.000000000937233701*c2*c4*s4*t2_d*t4_d + 9.34450651e-11*c2*s2*s4*t1_d*t2_d + 7.58899727e-11*c2*s2*s4*t1_d*t4_d - 4.898149856e-13*c4*s2*s4*t1_d*t2_d - 1.591182834e-12*c4*s2*s4*t1_d*t4_d - 3.073929188e-12*c4*s2*s4*t2_d*t4_d - 0.006296620384*c2*s2*t3*t1_d*t2_d - 0.001412256392*pow(c2,2)*pow(c4,2)*pow(s2,2)*t1_d*t3_d - 0.001412256392*pow(c2,2)*pow(s2,2)*pow(s4,2)*t1_d*t3_d + 0.007736652973*pow(c4,2)*pow(s2,3)*pow(t3,2)*t1_d*t2_d + 0.007736652973*pow(s2,3)*pow(s4,2)*pow(t3,2)*t1_d*t2_d + 0.003125529856*c2*pow(c4,2)*s2*t1_d*t2_d + 0.0000000004701665536*c2*pow(c4,2)*s2*t1_d*t3_d - 0.000000001148839953*c2*pow(c4,2)*s2*t1_d*t4_d - 0.000000001148839953*pow(c2,2)*c4*s4*t1_d*t2_d - 0.0000000007072965003*pow(c2,2)*c4*s4*t1_d*t4_d - 0.02989213166*c2*pow(c4,2)*t3*t2_d*t3_d + 0.00312553243*c2*s2*pow(s4,2)*t1_d*t2_d + 0.0000000004701665536*c2*s2*pow(s4,2)*t1_d*t3_d + 0.000000001148839953*c2*s2*pow(s4,2)*t1_d*t4_d + 0.000000001148839953*c4*pow(s2,2)*s4*t1_d*t2_d + 0.000000001866025403*c4*pow(s2,2)*s4*t1_d*t4_d + 0.2080961238*c2*s2*pow(t3,2)*t1_d*t2_d + 0.000008321632637*c2*pow(s2,2)*t3*t1_d*t2_d + 0.0003614612976*pow(c2,2)*s2*t3*t1_d*t2_d - 0.08712770474*c2*pow(s2,2)*t3*t1_d*t3_d - 0.02989213166*c2*pow(s4,2)*t3*t2_d*t3_d + 0.007736652973*pow(c2,2)*pow(c4,2)*s2*pow(t3,2)*t1_d*t2_d + 0.005306714589*pow(c2,2)*pow(c4,2)*pow(s2,2)*t3*t1_d*t3_d + 0.007736652973*pow(c2,2)*s2*pow(s4,2)*pow(t3,2)*t1_d*t2_d + 0.005306714589*pow(c2,2)*pow(s2,2)*pow(s4,2)*t3*t1_d*t3_d - 0.01967019404*c2*pow(c4,2)*s2*t3*t1_d*t2_d - 0.01967019404*c2*s2*pow(s4,2)*t3*t1_d*t2_d + 0.03695649964*c2*pow(c4,2)*s2*pow(t3,2)*t1_d*t2_d + 9.84269479e-11*c2*pow(c4,2)*pow(s2,2)*t3*t1_d*t2_d - 0.004117777963*pow(c2,2)*pow(c4,2)*s2*t3*t1_d*t2_d - 0.01547330595*c2*pow(c4,2)*pow(s2,2)*t3*t1_d*t3_d + 0.03695649964*c2*s2*pow(s4,2)*pow(t3,2)*t1_d*t2_d + 9.84269479e-11*c2*pow(s2,2)*pow(s4,2)*t3*t1_d*t2_d - 0.004117777963*pow(c2,2)*s2*pow(s4,2)*t3*t1_d*t2_d - 0.01547330595*c2*pow(s2,2)*pow(s4,2)*t3*t1_d*t3_d + 5.196154522e-12*c2*c4*s2*s4*t1_d*t2_d + 4.639567174e-12*c2*c4*s2*s4*t1_d*t4_d;
  
	double r2_1 =0.005125892675*pow(c2,2)*pow(c4,2)*pow(t3,2) - 0.002728269845*pow(c2,2)*pow(c4,2)*t3 + 0.0003630321984*pow(c2,2)*pow(c4,2) + 0.005125892675*pow(c2,2)*pow(s4,2)*pow(t3,2) - 0.002728269845*pow(c2,2)*pow(s4,2)*t3 + 0.0003630321984*pow(c2,2)*pow(s4,2) + 0.02886307975*pow(c2,2)*pow(t3,2) - 0.0008733457067*pow(c2,2)*t3 + 0.002292113373*pow(c2,2) - 0.01494606583*c2*pow(c4,2)*pow(t3,2) + 0.007954936163*c2*pow(c4,2)*t3 - 0.001263998513*c2*pow(c4,2) + 9.462498894e-13*c2*c4*s4 - 6.855943177e-13*c2*c4 - 0.01494606583*c2*pow(s4,2)*pow(t3,2) + 0.007954936163*c2*pow(s4,2)*t3 - 0.001263998045*c2*pow(s4,2) + 1.206017627e-11*c2*s4 - 0.08415890019*c2*pow(t3,2) - 0.0006982896052*c2*t3 - 0.01417965112*c2 + 0.005125892675*pow(c4,2)*pow(s2,2)*pow(t3,2) - 0.002728269845*pow(c4,2)*pow(s2,2)*t3 + 0.0003630321984*pow(c4,2)*pow(s2,2) + 0.000000000190146262*pow(c4,2)*s2*t3 - 4.983373431e-11*pow(c4,2)*s2 + 0.00007048126535*pow(c4,2) + 0.0000000007611599382*c4*s2*s4 - 3.069166558e-11*c4*s2 - 3.245252249e-13*c4*s4 - 7.367983117e-13*c4 + 0.005125892675*pow(s2,2)*pow(s4,2)*pow(t3,2) - 0.002728269845*pow(s2,2)*pow(s4,2)*t3 + 0.0003630321984*pow(s2,2)*pow(s4,2) + 0.02886307975*pow(s2,2)*pow(t3,2) - 0.0008733457067*pow(s2,2)*t3 + 0.002292113373*pow(s2,2) + 0.000000000190146262*s2*pow(s4,2)*t3 - 5.137069891e-11*s2*pow(s4,2) - 1.744753215e-12*s2*s4 + 0.00001607615976*s2*t3 - 0.000373703523*s2 + 0.00007048110464*pow(s4,2) + 1.296089671e-11*s4 + 0.001424956624;
	double r2_2 =0.01980492847*pow(c4,2)*pow(t3,2) - 0.01054122522*pow(c4,2)*t3 + 0.001674967403*pow(c4,2) - 1.253869184e-12*c4*s4 - 2.846770072e-12*c4 + 0.01980492847*pow(s4,2)*pow(t3,2) - 0.01054122522*pow(s4,2)*t3 + 0.001674966782*pow(s4,2) + 5.007705946e-11*s4 + 0.1115183766*pow(t3,2) - 0.003374348694*t3 + 0.01436165563;
	double r2_3 =-0.00002130266008;
	double r2_4 =4.066931379e-11*s4 - 2.31196051e-12*c4 + 0.00000024536634;
	double e2_left =0.4167136714*c1*c2 - 0.002818228598*pow(s2,3)*pow(t1_d,2) - 0.0003088889524*pow(s2,2)*pow(t1_d,2) + 0.01174186687*c1*s2 + 0.003039018772*c2*s1 - 0.1078534345*s1*s2 - 0.003374348694*t2_d*t3_d + 0.00002940555986*c2*pow(t1_d,2) + 4.066931379e-11*c4*pow(t4_d,2) - 0.0008517351657*s2*pow(t1_d,2) + 2.31196051e-12*s4*pow(t4_d,2) + 0.0003088889524*pow(c2,2)*pow(t1_d,2) + 0.00006731602911*pow(c2,3)*pow(t1_d,2) - 0.0131832924*c2*s2*pow(t1_d,2) + 4.515753845e-13*c2*s4*pow(t1_d,2) - 1.774448667e-13*c4*s2*pow(t1_d,2) - 0.0008733457067*pow(c2,2)*t1_d*t3_d - 3.245252249e-13*pow(c4,2)*t1_d*t4_d - 0.01054122522*pow(c4,2)*t2_d*t3_d - 1.253869184e-12*pow(c4,2)*t2_d*t4_d + 3.121403306e-12*s2*s4*pow(t1_d,2) - 0.0008733457067*pow(s2,2)*t1_d*t3_d + 3.245252249e-13*pow(s4,2)*t1_d*t4_d - 0.01054122522*pow(s4,2)*t2_d*t3_d + 1.253869184e-12*pow(s4,2)*t2_d*t4_d - 1.988978543e-13*c2*pow(c4,2)*pow(t1_d,2) + 3.794498635e-11*pow(c2,2)*c4*pow(t1_d,2) + 0.00006731602911*c2*pow(s2,2)*pow(t1_d,2) - 0.002818228598*pow(c2,2)*s2*pow(t1_d,2) + 1.988978543e-13*c2*pow(s4,2)*pow(t1_d,2) - 3.794498635e-11*c4*pow(s2,2)*pow(t1_d,2) + 2.157088582e-12*pow(c2,2)*s4*pow(t1_d,2) - 0.00005318967112*pow(c4,2)*s2*pow(t1_d,2) - 0.00001987541736*pow(c2,2)*t3*pow(t1_d,2) - 0.000004160816319*pow(c2,3)*t3*pow(t1_d,2) - 0.00005318954984*s2*pow(s4,2)*pow(t1_d,2) - 2.157088582e-12*pow(s2,2)*s4*pow(t1_d,2) + 0.00001987541736*pow(s2,2)*t3*pow(t1_d,2) - 0.0001807306488*pow(s2,3)*t3*pow(t1_d,2) + 1.634852846*c1*c2*t3 + 0.00254664601*c2*t1_d*t3_d + 1.296089671e-11*c4*t1_d*t4_d + 5.007705946e-11*c4*t2_d*t4_d + 6.31409175e-11*pow(c2,2)*pow(c4,2)*pow(t1_d,2) + 1.309681738e-11*pow(c2,3)*pow(c4,2)*pow(t1_d,2) - 0.4231310524*s1*s2*t3 + 0.00003215250967*s2*t1_d*t3_d + 0.000000303353443*s2*t1_d*t4_d + 7.367983117e-13*s4*t1_d*t4_d + 2.846770072e-12*s4*t2_d*t4_d + 0.2230367532*t3*t2_d*t3_d + 6.19810257e-11*pow(c2,2)*pow(s4,2)*pow(t1_d,2) - 6.31409175e-11*pow(c4,2)*pow(s2,2)*pow(t1_d,2) + 1.309681738e-11*pow(c2,3)*pow(s4,2)*pow(t1_d,2) - 0.0002739572171*pow(c4,2)*pow(s2,3)*pow(t1_d,2) - 6.19810257e-11*pow(s2,2)*pow(s4,2)*pow(t1_d,2) - 0.0002739572171*pow(s2,3)*pow(s4,2)*pow(t1_d,2) - 0.02178192619*pow(s2,3)*pow(t3,2)*pow(t1_d,2) + 7.943587577e-12*c2*c4*pow(t1_d,2) + 6.191170476e-11*c2*c4*t1_d*t4_d + 3.519543418e-12*c2*s4*t1_d*t4_d - 0.0000000003214330391*c4*s4*t1_d*t4_d - 0.000000001241921895*c4*s4*t2_d*t4_d - 0.1683178004*c2*t3*t1_d*t3_d + 1.309681738e-11*c2*pow(c4,2)*pow(s2,2)*pow(t1_d,2) - 0.0002739572171*pow(c2,2)*pow(c4,2)*s2*pow(t1_d,2) - 0.0000000002350832768*pow(c2,2)*pow(c4,2)*t3*pow(t1_d,2) - 4.921347395e-11*pow(c2,3)*pow(c4,2)*t3*pow(t1_d,2) + 1.309681738e-11*c2*pow(s2,2)*pow(s4,2)*pow(t1_d,2) - 0.0002739572171*pow(c2,2)*s2*pow(s4,2)*pow(t1_d,2) - 0.02178192619*pow(c2,2)*s2*pow(t3,2)*pow(t1_d,2) - 0.0000000002350832768*pow(c2,2)*pow(s4,2)*t3*pow(t1_d,2) + 0.0000000002350832768*pow(c4,2)*pow(s2,2)*t3*pow(t1_d,2) - 4.921347395e-11*pow(c2,3)*pow(s4,2)*t3*pow(t1_d,2) + 0.002058888982*pow(c4,2)*pow(s2,3)*t3*pow(t1_d,2) + 0.0000000002350832768*pow(s2,2)*pow(s4,2)*t3*pow(t1_d,2) + 0.002058888982*pow(s2,3)*pow(s4,2)*t3*pow(t1_d,2) + 2.656072817e-12*c2*c4*s2*pow(t1_d,2) - 0.0000000001970026884*c2*c4*s4*pow(t1_d,2) + 0.007954936163*c2*pow(c4,2)*t1_d*t3_d + 9.462498894e-13*c2*pow(c4,2)*t1_d*t4_d - 4.672253255e-11*c2*s2*s4*pow(t1_d,2) + 2.449074928e-13*c4*s2*s4*pow(t1_d,2) + 0.003148310192*c2*s2*t3*pow(t1_d,2) + 0.007954936163*c2*pow(s4,2)*t1_d*t3_d + 0.000000000190146262*pow(c4,2)*s2*t1_d*t3_d - 9.462498894e-13*c2*pow(s4,2)*t1_d*t4_d + 0.0000000007611599382*pow(c4,2)*s2*t1_d*t4_d + 0.05772615949*pow(c2,2)*t3*t1_d*t3_d + 0.03960985694*pow(c4,2)*t3*t2_d*t3_d + 0.000000000190146262*s2*pow(s4,2)*t1_d*t3_d - 0.0000000007611599382*s2*pow(s4,2)*t1_d*t4_d + 0.05772615949*pow(s2,2)*t3*t1_d*t3_d + 0.03960985694*pow(s4,2)*t3*t2_d*t3_d - 0.003868326487*pow(c4,2)*pow(s2,3)*pow(t3,2)*pow(t1_d,2) - 0.003868326487*pow(s2,3)*pow(s4,2)*pow(t3,2)*pow(t1_d,2) - 0.001562764928*c2*pow(c4,2)*s2*pow(t1_d,2) + 0.0000000005744199764*pow(c2,2)*c4*s4*pow(t1_d,2) - 0.002728269845*pow(c2,2)*pow(c4,2)*t1_d*t3_d - 0.001562766215*c2*s2*pow(s4,2)*pow(t1_d,2) - 0.0000000005744199764*c4*pow(s2,2)*s4*pow(t1_d,2) - 0.1040480619*c2*s2*pow(t3,2)*pow(t1_d,2) - 0.000004160816319*c2*pow(s2,2)*t3*pow(t1_d,2) - 0.0001807306488*pow(c2,2)*s2*t3*pow(t1_d,2) - 0.002728269845*pow(c2,2)*pow(s4,2)*t1_d*t3_d - 0.002728269845*pow(c4,2)*pow(s2,2)*t1_d*t3_d - 0.002728269845*pow(s2,2)*pow(s4,2)*t1_d*t3_d - 0.003868326487*pow(c2,2)*s2*pow(s4,2)*pow(t3,2)*pow(t1_d,2) + 0.00983509702*c2*pow(c4,2)*s2*t3*pow(t1_d,2) + 0.01025178535*pow(c2,2)*pow(c4,2)*t3*t1_d*t3_d + 0.00983509702*c2*s2*pow(s4,2)*t3*pow(t1_d,2) + 0.01025178535*pow(c2,2)*pow(s4,2)*t3*t1_d*t3_d + 0.01025178535*pow(c4,2)*pow(s2,2)*t3*t1_d*t3_d + 0.01025178535*pow(s2,2)*pow(s4,2)*t3*t1_d*t3_d + 0.000000000937233701*c2*c4*s4*t1_d*t4_d - 3.073929188e-12*c4*s2*s4*t1_d*t4_d - 0.01847824982*c2*pow(c4,2)*s2*pow(t3,2)*pow(t1_d,2) - 4.921347395e-11*c2*pow(c4,2)*pow(s2,2)*t3*pow(t1_d,2) + 0.002058888982*pow(c2,2)*pow(c4,2)*s2*t3*pow(t1_d,2) - 0.01847824982*c2*s2*pow(s4,2)*pow(t3,2)*pow(t1_d,2) - 4.921347395e-11*c2*pow(s2,2)*pow(s4,2)*t3*pow(t1_d,2) + 0.002058888982*pow(c2,2)*s2*pow(s4,2)*t3*pow(t1_d,2) - 2.598077261e-12*c2*c4*s2*s4*pow(t1_d,2) - 0.02989213166*c2*pow(c4,2)*t3*t1_d*t3_d - 0.02989213166*c2*pow(s4,2)*t3*t1_d*t3_d - 0.003868326487*pow(c2,2)*pow(c4,2)*s2*pow(t3,2)*pow(t1_d,2);
 
	double r3_1 =- 0.000005513534141*pow(c2,2) + 0.00001607634991*c2 - 0.000005513534141*pow(s2,2) - 0.003244935615*s2;
	double r3_2 =-0.00002130266008;
	double r3_3 =0.211484;
	double r3_4 =0;
	double e3_left =0.00008630544221*pow(s2,2)*pow(t1_d,2) - 1.23376453*s1 - 0.000004160816319*pow(s2,3)*pow(t1_d,2) + 0.0001130192509*pow(s2,4)*pow(t1_d,2) + 0.005270612608*pow(s4,2)*pow(t2_d,2) + 1.634852846*c1*s2 + 0.4231310524*c2*s1 - 0.1115183766*t3*pow(t2_d,2) + 0.001687174347*pow(t2_d,2) - 0.001487849654*pow(c2,2)*pow(t1_d,2) + 0.0001807306488*pow(c2,3)*pow(t1_d,2) + 0.0001130192509*pow(c2,4)*pow(t1_d,2) + 0.005270612608*pow(c4,2)*pow(t2_d,2) - 0.00001987541736*c2*s2*pow(t1_d,2) + 0.0008733457067*pow(c2,2)*t1_d*t2_d + 0.0008733457067*pow(s2,2)*t1_d*t2_d + 0.0001807306488*c2*pow(s2,2)*pow(t1_d,2) - 0.000004160816319*pow(c2,2)*s2*pow(t1_d,2) - 0.06351168926*pow(c2,2)*t3*pow(t1_d,2) + 0.04356385237*pow(c2,3)*t3*pow(t1_d,2) - 0.007470314739*pow(c2,4)*t3*pow(t1_d,2) - 0.01980492847*pow(c4,2)*t3*pow(t2_d,2) - 0.1675597511*pow(s2,2)*t3*pow(t1_d,2) - 0.007470314739*pow(s2,4)*t3*pow(t1_d,2) - 0.01980492847*pow(s4,2)*t3*pow(t2_d,2) - 0.00254664601*c2*t1_d*t2_d + 0.003001596496*pow(c2,2)*pow(c4,2)*pow(t1_d,2) - 0.002058888982*pow(c2,3)*pow(c4,2)*pow(t1_d,2) + 0.000353064098*pow(c2,4)*pow(c4,2)*pow(t1_d,2) - 0.00003215250967*s2*t1_d*t2_d + 0.0002260385019*pow(c2,2)*pow(s2,2)*pow(t1_d,2) + 0.003001596496*pow(c2,2)*pow(s4,2)*pow(t1_d,2) + 0.007919145006*pow(c4,2)*pow(s2,2)*pow(t1_d,2) - 0.002058888982*pow(c2,3)*pow(s4,2)*pow(t1_d,2) - 4.921347395e-11*pow(c4,2)*pow(s2,3)*pow(t1_d,2) + 0.000353064098*pow(c2,4)*pow(s4,2)*pow(t1_d,2) + 0.000353064098*pow(c4,2)*pow(s2,4)*pow(t1_d,2) + 0.007919145006*pow(s2,2)*pow(s4,2)*pow(t1_d,2) - 4.921347395e-11*pow(s2,3)*pow(s4,2)*pow(t1_d,2) + 0.000353064098*pow(s2,4)*pow(s4,2)*pow(t1_d,2) + 0.1683178004*c2*t3*t1_d*t2_d - 0.002058888982*c2*pow(c4,2)*pow(s2,2)*pow(t1_d,2) - 4.921347395e-11*pow(c2,2)*pow(c4,2)*s2*pow(t1_d,2) - 0.01127925729*pow(c2,2)*pow(c4,2)*t3*pow(t1_d,2) + 0.007736652973*pow(c2,3)*pow(c4,2)*t3*pow(t1_d,2) - 0.001326678647*pow(c2,4)*pow(c4,2)*t3*pow(t1_d,2) - 0.002058888982*c2*pow(s2,2)*pow(s4,2)*pow(t1_d,2) - 4.921347395e-11*pow(c2,2)*s2*pow(s4,2)*pow(t1_d,2) - 0.01494062948*pow(c2,2)*pow(s2,2)*t3*pow(t1_d,2) - 0.01127925729*pow(c2,2)*pow(s4,2)*t3*pow(t1_d,2) - 0.02975750711*pow(c4,2)*pow(s2,2)*t3*pow(t1_d,2) + 0.007736652973*pow(c2,3)*pow(s4,2)*t3*pow(t1_d,2) - 0.001326678647*pow(c2,4)*pow(s4,2)*t3*pow(t1_d,2) - 0.001326678647*pow(c4,2)*pow(s2,4)*t3*pow(t1_d,2) - 0.02975750711*pow(s2,2)*pow(s4,2)*t3*pow(t1_d,2) - 0.001326678647*pow(s2,4)*pow(s4,2)*t3*pow(t1_d,2) - 0.007954936163*c2*pow(c4,2)*t1_d*t2_d - 0.007954936163*c2*pow(s4,2)*t1_d*t2_d - 0.000000000190146262*pow(c4,2)*s2*t1_d*t2_d - 0.05772615949*pow(c2,2)*t3*t1_d*t2_d + 0.000706128196*pow(c2,2)*pow(c4,2)*pow(s2,2)*pow(t1_d,2) - 0.000000000190146262*s2*pow(s4,2)*t1_d*t2_d - 0.05772615949*pow(s2,2)*t3*t1_d*t2_d + 0.000706128196*pow(c2,2)*pow(s2,2)*pow(s4,2)*pow(t1_d,2) - 0.0000000002350832768*c2*pow(c4,2)*s2*pow(t1_d,2) + 0.002728269845*pow(c2,2)*pow(c4,2)*t1_d*t2_d - 0.0000000002350832768*c2*s2*pow(s4,2)*pow(t1_d,2) + 0.04356385237*c2*pow(s2,2)*t3*pow(t1_d,2) + 0.002728269845*pow(c2,2)*pow(s4,2)*t1_d*t2_d + 0.002728269845*pow(c4,2)*pow(s2,2)*t1_d*t2_d + 0.002728269845*pow(s2,2)*pow(s4,2)*t1_d*t2_d - 0.002653357295*pow(c2,2)*pow(s2,2)*pow(s4,2)*t3*pow(t1_d,2) - 0.01025178535*pow(c2,2)*pow(c4,2)*t3*t1_d*t2_d - 0.01025178535*pow(c2,2)*pow(s4,2)*t3*t1_d*t2_d - 0.01025178535*pow(c4,2)*pow(s2,2)*t3*t1_d*t2_d - 0.01025178535*pow(s2,2)*pow(s4,2)*t3*t1_d*t2_d + 0.007736652973*c2*pow(c4,2)*pow(s2,2)*t3*pow(t1_d,2) + 0.007736652973*c2*pow(s2,2)*pow(s4,2)*t3*pow(t1_d,2) + 0.02989213166*c2*pow(c4,2)*t3*t1_d*t2_d + 0.02989213166*c2*pow(s4,2)*t3*t1_d*t2_d - 0.002653357295*pow(c2,2)*pow(c4,2)*pow(s2,2)*t3*pow(t1_d,2);
 
	double r4_1 =0.000000303353443*c2 - 5.983794116e-13*c4 + 1.052599296e-11*s4 + 1.744753284e-12*c2*c4 - 3.069166558e-11*c2*s4 - 4.985152849e-11*c4*s2 - 2.8339491e-12*s2*s4 + 0.00000006350548183;
	double r4_2 =4.066931379e-11*s4 - 2.31196051e-12*c4 + 0.00000024536634;
	double r4_3 =0;
	double r4_4 =0.000000398541;
	double e4_left =3.570503464e-13*pow(c2,2)*pow(c4,2)*pow(t1_d,2) + 0.0000000003536482501*pow(c2,2)*c4*s4*pow(t1_d,2) + 2.336126628e-11*pow(c2,2)*c4*pow(t1_d,2) - 3.570503464e-13*pow(c2,2)*pow(s4,2)*pow(t1_d,2) + 1.328036296e-12*pow(c2,2)*s4*pow(t1_d,2) + 0.0000000005744199764*c2*pow(c4,2)*s2*pow(t1_d,2) - 2.449074928e-13*c2*pow(c4,2)*pow(t1_d,2) - 9.462498894e-13*c2*pow(c4,2)*t1_d*t2_d - 2.319783587e-12*c2*c4*s2*s4*pow(t1_d,2) + 2.157088582e-12*c2*c4*s2*pow(t1_d,2) - 0.0000000002425739316*c2*c4*s4*pow(t1_d,2) - 0.000000000937233701*c2*c4*s4*t1_d*t2_d - 3.121403306e-12*c2*c4*pow(t1_d,2) - 6.191170476e-11*c2*c4*t1_d*t2_d - 0.0000000005744199764*c2*s2*pow(s4,2)*pow(t1_d,2) - 3.794498635e-11*c2*s2*s4*pow(t1_d,2) + 2.449074928e-13*c2*pow(s4,2)*pow(t1_d,2) + 9.462498894e-13*c2*pow(s4,2)*t1_d*t2_d - 1.774448666e-13*c2*s4*pow(t1_d,2) - 3.519543418e-12*c2*s4*t1_d*t2_d - 9.419882841e-13*pow(c4,2)*pow(s2,2)*pow(t1_d,2) - 0.0000000001970026884*pow(c4,2)*s2*pow(t1_d,2) - 0.0000000007611599382*pow(c4,2)*s2*t1_d*t2_d + 4.199665442e-14*pow(c4,2)*pow(t1_d,2) + 3.245252249e-13*pow(c4,2)*t1_d*t2_d + 6.269345921e-13*pow(c4,2)*pow(t2_d,2) - 0.0000000009330127017*c4*pow(s2,2)*s4*pow(t1_d,2) + 7.955914171e-13*c4*s2*s4*pow(t1_d,2) + 3.073929188e-12*c4*s2*s4*t1_d*t2_d + 4.515753845e-13*c4*s2*pow(t1_d,2) + 4.159649613e-11*c4*s4*pow(t1_d,2) + 0.0000000003214330391*c4*s4*t1_d*t2_d + 0.0000000006209609477*c4*s4*pow(t2_d,2) - 1.677263455e-12*c4*pow(t1_d,2) - 1.296089671e-11*c4*t1_d*t2_d - 2.503852973e-11*c4*pow(t2_d,2) + 9.419882841e-13*pow(s2,2)*pow(s4,2)*pow(t1_d,2) + 0.0000000001970026884*s2*pow(s4,2)*pow(t1_d,2) + 0.0000000007611599382*s2*pow(s4,2)*t1_d*t2_d - 7.943587577e-12*s2*s4*pow(t1_d,2) - 0.000000303353443*s2*t1_d*t2_d - 4.199665442e-14*pow(s4,2)*pow(t1_d,2) - 3.245252249e-13*pow(s4,2)*t1_d*t2_d - 6.269345921e-13*pow(s4,2)*pow(t2_d,2) - 9.534871773e-14*s4*pow(t1_d,2) - 7.367983117e-13*s4*t1_d*t2_d - 1.423385036e-12*s4*pow(t2_d,2);
 
	Array2D<double> left_terms(4,1);
	left_terms[0][0]=e1_left;
	left_terms[1][0]=e2_left;
	left_terms[2][0]=e3_left;
	left_terms[3][0]=e4_left;

	Array2D<double> M(4,4);
	M[0][0]=r1_1;
	M[0][1]=r1_2;
	M[0][2]=r1_3;
	M[0][3]=r1_4;

	M[1][0]=r2_1;
	M[1][1]=r2_2;
	M[1][2]=r2_3;
	M[1][3]=r2_4;

	M[2][0]=r3_1;
	M[2][1]=r3_2;
	M[2][2]=r3_3;
	M[2][3]=r3_4;

	M[3][0]=r4_1;
	M[3][1]=r4_2;
	M[3][2]=r4_3;
	M[3][3]=r4_4;

	Array2D<double> right_side(4,1),dd(4,1);

	right_side=PID_control_gold(r,t)-left_terms;

	dd= matmult(inverse(M),right_side);

	drdt[4] = dd[0][0];
	drdt[5] = dd[1][0];
	drdt[6] = dd[2][0];
	drdt[7] = dd[3][0];
}




void sys_dyn_green( const state_type &r, state_type &drdt, double t )
{
	double r_dot[8]={0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0};
	double t1  =r[0];
	double t2  =r[1];
	double t3  =r[2];
	double t4  =r[3];
	double t1_d=r[4];
	double t2_d=r[5];
	double t3_d=r[6];
	double t4_d=r[7];

	drdt[0] = r[4];
	drdt[1] = r[5];
	drdt[2] = r[6];
	drdt[3] = r[7];

	double s1=sin(r[0]);
	double s2=sin(r[1]);
	double s4=sin(r[3]);
	double c1=cos(r[0]);
	double c2=cos(r[1]);
	double c4=cos(r[3]);

	double r1_1 =0.001326678647*pow(c2, 4.0)*pow(c4, 2.0)*pow(t3, 2.0) - 0.0007061831167*pow(c2, 4.0)*pow(c4, 2.0)*t3 + 0.00009397426334*pow(c2, 4.0)*pow(c4, 2.0) + 0.001326678647*pow(c2, 4.0)*pow(s4, 2.0)*pow(t3, 2.0) - 0.0007061831167*pow(c2, 4.0)*pow(s4, 2.0)*t3 + 0.00009397426334*pow(c2, 4.0)*pow(s4, 2.0) + 0.007470314739*pow(c2, 4.0)*pow(t3, 2.0) - 0.0002267126689*pow(c2, 4.0)*t3 + 0.0005932455411*pow(c2, 4.0) + 0.007736652973*pow(c2, 3.0)*pow(c4, 2.0)*pow(t3, 2.0) - 0.004118090172*pow(c2, 3.0)*pow(c4, 2.0)*t3 + 0.0005479975228*pow(c2, 3.0)*pow(c4, 2.0) + 0.007736652973*pow(c2, 3.0)*pow(s4, 2.0)*pow(t3, 2.0) - 0.004118090172*pow(c2, 3.0)*pow(s4, 2.0)*t3 + 0.0005479975228*pow(c2, 3.0)*pow(s4, 2.0) + 0.04356385237*pow(c2, 3.0)*pow(t3, 2.0) + 0.0003575275713*pow(c2, 3.0)*t3 + 0.005636358357*pow(c2, 3.0) + 0.002653357295*pow(c2, 2.0)*pow(c4, 2.0)*pow(s2, 2.0)*pow(t3, 2.0) - 0.001412366233*pow(c2, 2.0)*pow(c4, 2.0)*pow(s2, 2.0)*t3 + 0.0001879485267*pow(c2, 2.0)*pow(c4, 2.0)*pow(s2, 2.0) + 9.84269479e-11*pow(c2, 2.0)*pow(c4, 2.0)*s2*t3 - 2.619563316e-11*pow(c2, 2.0)*pow(c4, 2.0)*s2 + 0.01127925729*pow(c2, 2.0)*pow(c4, 2.0)*pow(t3, 2.0) - 0.0060036364*pow(c2, 2.0)*pow(c4, 2.0)*t3 + 0.0009539826807*pow(c2, 2.0)*pow(c4, 2.0) - 7.141006928e-13*pow(c2, 2.0)*c4*s4 + 2.656072578e-12*pow(c2, 2.0)*c4 + 0.002653357295*pow(c2, 2.0)*pow(s2, 2.0)*pow(s4, 2.0)*pow(t3, 2.0) - 0.001412366233*pow(c2, 2.0)*pow(s2, 2.0)*pow(s4, 2.0)*t3 + 0.0001879485267*pow(c2, 2.0)*pow(s2, 2.0)*pow(s4, 2.0) + 0.01494062948*pow(c2, 2.0)*pow(s2, 2.0)*pow(t3, 2.0) - 0.0004534253379*pow(c2, 2.0)*pow(s2, 2.0)*t3 + 0.001186491082*pow(c2, 2.0)*pow(s2, 2.0) + 9.84269479e-11*pow(c2, 2.0)*s2*pow(s4, 2.0)*t3 - 2.619563316e-11*pow(c2, 2.0)*s2*pow(s4, 2.0) + 0.000008321632637*pow(c2, 2.0)*s2*t3 + 0.0001350051026*pow(c2, 2.0)*s2 + 0.01127925729*pow(c2, 2.0)*pow(s4, 2.0)*pow(t3, 2.0) - 0.0060036364*pow(c2, 2.0)*pow(s4, 2.0)*t3 + 0.000953982327*pow(c2, 2.0)*pow(s4, 2.0) - 4.672253255e-11*pow(c2, 2.0)*s4 + 0.06351168926*pow(c2, 2.0)*pow(t3, 2.0) + 0.002969961042*pow(c2, 2.0)*t3 + 0.0159087929*pow(c2, 2.0) + 0.007736652973*c2*pow(c4, 2.0)*pow(s2, 2.0)*pow(t3, 2.0) - 0.004118090172*c2*pow(c4, 2.0)*pow(s2, 2.0)*t3 + 0.0005479975228*c2*pow(c4, 2.0)*pow(s2, 2.0) - 0.0000000004701665536*c2*pow(c4, 2.0)*s2*t3 + 0.000000000126291381*c2*pow(c4, 2.0)*s2 + 0.0001063793422*c2*pow(c4, 2.0) + 0.000000001148839953*c2*c4*s2*s4 + 7.58899727e-11*c2*c4*s2 - 4.898149856e-13*c2*c4*s4 + 3.548897269e-13*c2*c4 + 0.007736652973*c2*pow(s2, 2.0)*pow(s4, 2.0)*pow(t3, 2.0) - 0.004118090172*c2*pow(s2, 2.0)*pow(s4, 2.0)*t3 + 0.0005479975228*c2*pow(s2, 2.0)*pow(s4, 2.0) + 0.04356385237*c2*pow(s2, 2.0)*pow(t3, 2.0) + 0.0003575275713*c2*pow(s2, 2.0)*t3 + 0.005636358357*c2*pow(s2, 2.0) - 0.0000000004701665536*c2*s2*pow(s4, 2.0)*t3 + 0.0000000001239715974*c2*s2*pow(s4, 2.0) + 4.314177204e-12*c2*s2*s4 - 0.00003975083471*c2*s2*t3 - 0.0006248817104*c2*s2 + 0.0001063790997*c2*pow(s4, 2.0) - 6.242806612e-12*c2*s4 + 0.001703455331*c2 + 0.001326678647*pow(c4, 2.0)*pow(s2, 4.0)*pow(t3, 2.0) - 0.0007061831167*pow(c4, 2.0)*pow(s2, 4.0)*t3 + 0.00009397426334*pow(c4, 2.0)*pow(s2, 4.0) + 9.84269479e-11*pow(c4, 2.0)*pow(s2, 3.0)*t3 - 2.619563316e-11*pow(c4, 2.0)*pow(s2, 3.0) + 0.02975750711*pow(c4, 2.0)*pow(s2, 2.0)*pow(t3, 2.0) - 0.01583949837*pow(c4, 2.0)*pow(s2, 2.0)*t3 + 0.002516951189*pow(c4, 2.0)*pow(s2, 2.0) + 3.977957085e-13*pow(c4, 2.0)*s2 + 0.0000182418938*pow(c4, 2.0) + 1.883976568e-12*c4*pow(s2, 2.0)*s4 + 0.0000000003940053768*c4*s2*s4 - 1.588717515e-11*c4*s2 - 8.399330883e-14*c4*s4 - 1.906974358e-13*c4 + 0.001326678647*pow(s2, 4.0)*pow(s4, 2.0)*pow(t3, 2.0) - 0.0007061831167*pow(s2, 4.0)*pow(s4, 2.0)*t3 + 0.00009397426334*pow(s2, 4.0)*pow(s4, 2.0) + 0.007470314739*pow(s2, 4.0)*pow(t3, 2.0) - 0.0002267126689*pow(s2, 4.0)*t3 + 0.0005932455411*pow(s2, 4.0) + 9.84269479e-11*pow(s2, 3.0)*pow(s4, 2.0)*t3 - 2.619563316e-11*pow(s2, 3.0)*pow(s4, 2.0) + 0.000008321632637*pow(s2, 3.0)*t3 + 0.0001350051026*pow(s2, 3.0) + 0.02975750711*pow(s2, 2.0)*pow(s4, 2.0)*pow(t3, 2.0) - 0.01583949837*pow(s2, 2.0)*pow(s4, 2.0)*t3 + 0.002516952122*pow(s2, 2.0)*pow(s4, 2.0) + 0.1675597511*pow(s2, 2.0)*pow(t3, 2.0) - 0.0001877390858*pow(s2, 2.0)*t3 + 0.0290920725*pow(s2, 2.0) - 3.977957085e-13*s2*pow(s4, 2.0) - 9.031507707e-13*s2*s4 + 0.00005997388029*s2 + 0.0000182418522*pow(s4, 2.0) + 3.354526911e-12*s4 + 0.004626925789;
	double r1_2 =0.005125892675*pow(c2, 2.0)*pow(c4, 2.0)*pow(t3, 2.0) - 0.002728482042*pow(c2, 2.0)*pow(c4, 2.0)*t3 + 0.0003630886719*pow(c2, 2.0)*pow(c4, 2.0) + 0.005125892675*pow(c2, 2.0)*pow(s4, 2.0)*pow(t3, 2.0) - 0.002728482042*pow(c2, 2.0)*pow(s4, 2.0)*t3 + 0.0003630886719*pow(c2, 2.0)*pow(s4, 2.0) + 0.02886307975*pow(c2, 2.0)*pow(t3, 2.0) - 0.0008759504883*pow(c2, 2.0)*t3 + 0.002292124758*pow(c2, 2.0) + 0.01494606583*c2*pow(c4, 2.0)*pow(t3, 2.0) - 0.007955539304*c2*pow(c4, 2.0)*t3 + 0.001264159028*c2*pow(c4, 2.0) - 9.462498894e-13*c2*c4*s4 + 6.855943056e-13*c2*c4 + 0.01494606583*c2*pow(s4, 2.0)*pow(t3, 2.0) - 0.007955539304*c2*pow(s4, 2.0)*t3 + 0.00126415856*c2*pow(s4, 2.0) - 1.206017627e-11*c2*s4 + 0.08415890019*c2*pow(t3, 2.0) + 0.0006906902294*c2*t3 + 0.0141794312*c2 + 0.005125892675*pow(c4, 2.0)*pow(s2, 2.0)*pow(t3, 2.0) - 0.002728482042*pow(c4, 2.0)*pow(s2, 2.0)*t3 + 0.0003630886719*pow(c4, 2.0)*pow(s2, 2.0) + 0.000000000190146262*pow(c4, 2.0)*s2*t3 - 4.983759492e-11*pow(c4, 2.0)*s2 + 0.00007048126535*pow(c4, 2.0) + 0.0000000007611599381*c4*s2*s4 - 3.069166558e-11*c4*s2 - 3.245252249e-13*c4*s4 - 7.367983131e-13*c4 + 0.005125892675*pow(s2, 2.0)*pow(s4, 2.0)*pow(t3, 2.0) - 0.002728482042*pow(s2, 2.0)*pow(s4, 2.0)*t3 + 0.0003630886719*pow(s2, 2.0)*pow(s4, 2.0) + 0.02886307975*pow(s2, 2.0)*pow(t3, 2.0) - 0.0008759504883*pow(s2, 2.0)*t3 + 0.002292124758*pow(s2, 2.0) + 0.000000000190146262*s2*pow(s4, 2.0)*t3 - 5.137455952e-11*s2*pow(s4, 2.0) - 1.744753175e-12*s2*s4 + 0.00001607615976*s2*t3 + 0.0003766704703*s2 + 0.00007048110464*pow(s4, 2.0) + 1.296089671e-11*s4 + 0.001424943683;
	double r1_3 =0.000005513534141*pow(c2, 2.0) + 0.00001607634991*c2 + 0.000005513534141*pow(s2, 2.0) + 0.003244946839*s2;
	double r1_4 =0.000000303353443*c2 + 5.983794116e-13*c4 - 1.052599296e-11*s4 + 1.744753284e-12*c2*c4 - 3.069166558e-11*c2*s4 + 4.985152849e-11*c4*s2 + 2.8339491e-12*s2*s4 - 0.00000006350548183;
	double e1_left =0.9139680675*c1 + 0.02167608914*s1 + 0.1078355445*c1*c2 + 0.003175952808*c1*s2 + 0.01227093936*c2*s1 + 1.23376453*c1*t3 - 0.4166445498*s1*s2 + 0.0003766704703*c2*pow(t2_d, 2.0) - 1.052599296e-11*c4*pow(t4_d, 2.0) - 0.0141794312*s2*pow(t2_d, 2.0) - 5.983794116e-13*s4*pow(t4_d, 2.0) - 1.744753175e-12*c2*s4*pow(t2_d, 2.0) - 6.855943056e-13*c4*s2*pow(t2_d, 2.0) - 1.744753284e-12*c2*s4*pow(t4_d, 2.0) + 2.8339491e-12*c4*s2*pow(t4_d, 2.0) + 0.00001607615976*c2*t3*pow(t2_d, 2.0) - 0.0006248817104*pow(c2, 2.0)*t1_d*t2_d + 0.002969961042*pow(c2, 2.0)*t1_d*t3_d + 0.0001350051026*pow(c2, 3.0)*t1_d*t2_d - 0.0008759504883*pow(c2, 2.0)*t2_d*t3_d + 0.0003575275713*pow(c2, 3.0)*t1_d*t3_d - 0.0002267126689*pow(c2, 4.0)*t1_d*t3_d - 8.399330883e-14*pow(c4, 2.0)*t1_d*t4_d - 3.245252249e-13*pow(c4, 2.0)*t2_d*t4_d + 1.206017627e-11*s2*s4*pow(t2_d, 2.0) - 4.985152849e-11*s2*s4*pow(t4_d, 2.0) - 0.0006906902294*s2*t3*pow(t2_d, 2.0) + 0.0006248817104*pow(s2, 2.0)*t1_d*t2_d - 0.0001877390858*pow(s2, 2.0)*t1_d*t3_d - 0.005636358357*pow(s2, 3.0)*t1_d*t2_d - 0.0008759504883*pow(s2, 2.0)*t2_d*t3_d + 0.000008321632637*pow(s2, 3.0)*t1_d*t3_d - 0.0002267126689*pow(s2, 4.0)*t1_d*t3_d + 8.399330883e-14*pow(s4, 2.0)*t1_d*t4_d + 3.245252249e-13*pow(s4, 2.0)*t2_d*t4_d - 4.983759492e-11*c2*pow(c4, 2.0)*pow(t2_d, 2.0) - 5.137455952e-11*c2*pow(s4, 2.0)*pow(t2_d, 2.0) - 0.001264159028*pow(c4, 2.0)*s2*pow(t2_d, 2.0) - 0.00126415856*s2*pow(s4, 2.0)*pow(t2_d, 2.0) - 0.08415890019*s2*pow(t3, 2.0)*pow(t2_d, 2.0) + 0.4231310524*c1*c2*t3 + 0.00005997388029*c2*t1_d*t2_d + 0.003935637068*c2*t2_d*t3_d + 3.354526911e-12*c4*t1_d*t4_d + 1.296089671e-11*c4*t2_d*t4_d - 1.634852846*s1*s2*t3 - 0.001703455331*s2*t1_d*t2_d - 0.000000000190146262*s2*t2_d*t3_d - 0.000000303353443*s2*t2_d*t4_d + 1.906974358e-13*s4*t1_d*t4_d + 7.367983131e-13*s4*t2_d*t4_d - 3.069166558e-11*c2*c4*pow(t2_d, 2.0) - 3.069166558e-11*c2*c4*pow(t4_d, 2.0) - 1.588717515e-11*c2*c4*t1_d*t2_d - 6.242806612e-12*c2*c4*t1_d*t4_d + 3.779135222e-11*c2*c4*t2_d*t4_d + 0.02636655919*c2*s2*t1_d*t2_d - 0.00003975083471*c2*s2*t1_d*t3_d - 9.031507707e-13*c2*s4*t1_d*t2_d - 3.548897269e-13*c4*s2*t1_d*t2_d - 3.548897269e-13*c2*s4*t1_d*t4_d - 9.031507707e-13*c4*s2*t1_d*t4_d + 2.148354795e-12*c2*s4*t2_d*t4_d - 3.489506459e-12*c4*s2*t2_d*t4_d - 8.319299225e-11*c4*s4*t1_d*t4_d - 0.0000000003214330391*c4*s4*t2_d*t4_d + 0.1683178004*c2*t3*t2_d*t3_d + 6.242806612e-12*s2*s4*t1_d*t2_d + 1.588717515e-11*s2*s4*t1_d*t4_d + 6.138333115e-11*s2*s4*t2_d*t4_d - 0.01494606583*pow(c4, 2.0)*s2*pow(t3, 2.0)*pow(t2_d, 2.0) - 0.01494606583*s2*pow(s4, 2.0)*pow(t3, 2.0)*pow(t2_d, 2.0) + 0.0000000007611599381*c2*c4*s4*pow(t2_d, 2.0) + 3.977957085e-13*c2*pow(c4, 2.0)*t1_d*t2_d + 7.58899727e-11*pow(c2, 2.0)*c4*t1_d*t2_d - 4.898149856e-13*c2*pow(c4, 2.0)*t1_d*t4_d - 0.007955539304*c2*pow(c4, 2.0)*t2_d*t3_d - 4.672253255e-11*pow(c2, 2.0)*c4*t1_d*t4_d - 9.462498894e-13*c2*pow(c4, 2.0)*t2_d*t4_d + 9.462498894e-13*c4*s2*s4*pow(t2_d, 2.0) + 0.0001350051026*c2*pow(s2, 2.0)*t1_d*t2_d - 0.005636358357*pow(c2, 2.0)*s2*t1_d*t2_d + 0.0003575275713*c2*pow(s2, 2.0)*t1_d*t3_d + 0.000008321632637*pow(c2, 2.0)*s2*t1_d*t3_d - 3.977957085e-13*c2*pow(s4, 2.0)*t1_d*t2_d - 7.58899727e-11*c4*pow(s2, 2.0)*t1_d*t2_d + 4.314177204e-12*pow(c2, 2.0)*s4*t1_d*t2_d - 0.0001063793422*pow(c4, 2.0)*s2*t1_d*t2_d + 4.898149856e-13*c2*pow(s4, 2.0)*t1_d*t4_d - 0.007955539304*c2*pow(s4, 2.0)*t2_d*t3_d - 2.656072578e-12*pow(c2, 2.0)*s4*t1_d*t4_d + 0.0000000003940053768*pow(c4, 2.0)*s2*t1_d*t4_d + 0.000000000190146262*pow(c4, 2.0)*s2*t2_d*t3_d + 9.462498894e-13*c2*pow(s4, 2.0)*t2_d*t4_d + 0.0000000007611599381*pow(c4, 2.0)*s2*t2_d*t4_d - 0.00003975083471*pow(c2, 2.0)*t3*t1_d*t2_d + 0.1270233785*pow(c2, 2.0)*t3*t1_d*t3_d + 0.000008321632637*pow(c2, 3.0)*t3*t1_d*t2_d + 0.05772615949*pow(c2, 2.0)*t3*t2_d*t3_d + 0.08712770474*pow(c2, 3.0)*t3*t1_d*t3_d + 0.01494062948*pow(c2, 4.0)*t3*t1_d*t3_d - 0.0001063790997*s2*pow(s4, 2.0)*t1_d*t2_d - 4.314177204e-12*pow(s2, 2.0)*s4*t1_d*t2_d - 0.0000000003940053768*s2*pow(s4, 2.0)*t1_d*t4_d + 0.000000000190146262*s2*pow(s4, 2.0)*t2_d*t3_d - 0.0000000007611599381*s2*pow(s4, 2.0)*t2_d*t4_d + 0.00003975083471*pow(s2, 2.0)*t3*t1_d*t2_d + 0.3351195023*pow(s2, 2.0)*t3*t1_d*t3_d - 0.0003575275713*pow(s2, 3.0)*t3*t1_d*t2_d + 0.05772615949*pow(s2, 2.0)*t3*t2_d*t3_d + 0.01494062948*pow(s2, 4.0)*t3*t1_d*t3_d + 0.000000000190146262*c2*pow(c4, 2.0)*t3*pow(t2_d, 2.0) + 0.000000000126291381*pow(c2, 2.0)*pow(c4, 2.0)*t1_d*t2_d - 0.0060036364*pow(c2, 2.0)*pow(c4, 2.0)*t1_d*t3_d - 2.619563316e-11*pow(c2, 3.0)*pow(c4, 2.0)*t1_d*t2_d - 7.141006928e-13*pow(c2, 2.0)*pow(c4, 2.0)*t1_d*t4_d - 0.002728482042*pow(c2, 2.0)*pow(c4, 2.0)*t2_d*t3_d - 0.004118090172*pow(c2, 3.0)*pow(c4, 2.0)*t1_d*t3_d - 0.0007061831167*pow(c2, 4.0)*pow(c4, 2.0)*t1_d*t3_d + 0.000000000190146262*c2*pow(s4, 2.0)*t3*pow(t2_d, 2.0) + 0.007955539304*pow(c4, 2.0)*s2*t3*pow(t2_d, 2.0) - 0.0004534253379*pow(c2, 2.0)*pow(s2, 2.0)*t1_d*t3_d + 0.0000000001239715974*pow(c2, 2.0)*pow(s4, 2.0)*t1_d*t2_d - 0.000000000126291381*pow(c4, 2.0)*pow(s2, 2.0)*t1_d*t2_d - 0.0060036364*pow(c2, 2.0)*pow(s4, 2.0)*t1_d*t3_d - 2.619563316e-11*pow(c2, 3.0)*pow(s4, 2.0)*t1_d*t2_d - 0.01583949837*pow(c4, 2.0)*pow(s2, 2.0)*t1_d*t3_d - 0.0005479975228*pow(c4, 2.0)*pow(s2, 3.0)*t1_d*t2_d + 7.141006928e-13*pow(c2, 2.0)*pow(s4, 2.0)*t1_d*t4_d - 0.002728482042*pow(c2, 2.0)*pow(s4, 2.0)*t2_d*t3_d - 0.004118090172*pow(c2, 3.0)*pow(s4, 2.0)*t1_d*t3_d + 1.883976568e-12*pow(c4, 2.0)*pow(s2, 2.0)*t1_d*t4_d - 0.002728482042*pow(c4, 2.0)*pow(s2, 2.0)*t2_d*t3_d + 9.84269479e-11*pow(c4, 2.0)*pow(s2, 3.0)*t1_d*t3_d - 0.0007061831167*pow(c2, 4.0)*pow(s4, 2.0)*t1_d*t3_d - 0.0007061831167*pow(c4, 2.0)*pow(s2, 4.0)*t1_d*t3_d + 0.007955539304*s2*pow(s4, 2.0)*t3*pow(t2_d, 2.0) - 0.0000000001239715974*pow(s2, 2.0)*pow(s4, 2.0)*t1_d*t2_d - 0.01583949837*pow(s2, 2.0)*pow(s4, 2.0)*t1_d*t3_d - 0.0005479975228*pow(s2, 3.0)*pow(s4, 2.0)*t1_d*t2_d - 1.883976568e-12*pow(s2, 2.0)*pow(s4, 2.0)*t1_d*t4_d - 0.002728482042*pow(s2, 2.0)*pow(s4, 2.0)*t2_d*t3_d + 9.84269479e-11*pow(s2, 3.0)*pow(s4, 2.0)*t1_d*t3_d - 0.0007061831167*pow(s2, 4.0)*pow(s4, 2.0)*t1_d*t3_d - 0.04356385237*pow(s2, 3.0)*pow(t3, 2.0)*t1_d*t2_d - 2.619563316e-11*c2*pow(c4, 2.0)*pow(s2, 2.0)*t1_d*t2_d - 0.0005479975228*pow(c2, 2.0)*pow(c4, 2.0)*s2*t1_d*t2_d - 0.004118090172*c2*pow(c4, 2.0)*pow(s2, 2.0)*t1_d*t3_d + 9.84269479e-11*pow(c2, 2.0)*pow(c4, 2.0)*s2*t1_d*t3_d - 0.0000000004701665536*pow(c2, 2.0)*pow(c4, 2.0)*t3*t1_d*t2_d + 0.02255851458*pow(c2, 2.0)*pow(c4, 2.0)*t3*t1_d*t3_d + 9.84269479e-11*pow(c2, 3.0)*pow(c4, 2.0)*t3*t1_d*t2_d + 0.01025178535*pow(c2, 2.0)*pow(c4, 2.0)*t3*t2_d*t3_d + 0.01547330595*pow(c2, 3.0)*pow(c4, 2.0)*t3*t1_d*t3_d + 0.002653357295*pow(c2, 4.0)*pow(c4, 2.0)*t3*t1_d*t3_d - 2.619563316e-11*c2*pow(s2, 2.0)*pow(s4, 2.0)*t1_d*t2_d - 0.0005479975228*pow(c2, 2.0)*s2*pow(s4, 2.0)*t1_d*t2_d - 0.004118090172*c2*pow(s2, 2.0)*pow(s4, 2.0)*t1_d*t3_d + 9.84269479e-11*pow(c2, 2.0)*s2*pow(s4, 2.0)*t1_d*t3_d - 0.04356385237*pow(c2, 2.0)*s2*pow(t3, 2.0)*t1_d*t2_d + 0.02988125896*pow(c2, 2.0)*pow(s2, 2.0)*t3*t1_d*t3_d - 0.0000000004701665536*pow(c2, 2.0)*pow(s4, 2.0)*t3*t1_d*t2_d + 0.0000000004701665536*pow(c4, 2.0)*pow(s2, 2.0)*t3*t1_d*t2_d + 0.02255851458*pow(c2, 2.0)*pow(s4, 2.0)*t3*t1_d*t3_d + 9.84269479e-11*pow(c2, 3.0)*pow(s4, 2.0)*t3*t1_d*t2_d + 0.05951501423*pow(c4, 2.0)*pow(s2, 2.0)*t3*t1_d*t3_d + 0.004118090172*pow(c4, 2.0)*pow(s2, 3.0)*t3*t1_d*t2_d + 0.01025178535*pow(c2, 2.0)*pow(s4, 2.0)*t3*t2_d*t3_d + 0.01547330595*pow(c2, 3.0)*pow(s4, 2.0)*t3*t1_d*t3_d + 0.01025178535*pow(c4, 2.0)*pow(s2, 2.0)*t3*t2_d*t3_d + 0.002653357295*pow(c2, 4.0)*pow(s4, 2.0)*t3*t1_d*t3_d + 0.002653357295*pow(c4, 2.0)*pow(s2, 4.0)*t3*t1_d*t3_d + 0.0000000004701665536*pow(s2, 2.0)*pow(s4, 2.0)*t3*t1_d*t2_d + 0.05951501423*pow(s2, 2.0)*pow(s4, 2.0)*t3*t1_d*t3_d + 0.004118090172*pow(s2, 3.0)*pow(s4, 2.0)*t3*t1_d*t2_d + 0.01025178535*pow(s2, 2.0)*pow(s4, 2.0)*t3*t2_d*t3_d + 0.002653357295*pow(s2, 4.0)*pow(s4, 2.0)*t3*t1_d*t3_d - 5.312145813e-12*c2*c4*s2*t1_d*t2_d + 4.314177204e-12*c2*c4*s2*t1_d*t4_d + 0.0000000003940053768*c2*c4*s4*t1_d*t2_d - 0.0000000004851478632*c2*c4*s4*t1_d*t4_d - 0.0000000009372337008*c2*c4*s4*t2_d*t4_d + 9.34450651e-11*c2*s2*s4*t1_d*t2_d - 7.58899727e-11*c2*s2*s4*t1_d*t4_d + 4.898149856e-13*c4*s2*s4*t1_d*t2_d - 1.591182834e-12*c4*s2*s4*t1_d*t4_d - 3.073929188e-12*c4*s2*s4*t2_d*t4_d - 0.006315400256*c2*s2*t3*t1_d*t2_d - 0.001412366233*pow(c2, 2.0)*pow(c4, 2.0)*pow(s2, 2.0)*t1_d*t3_d - 0.001412366233*pow(c2, 2.0)*pow(s2, 2.0)*pow(s4, 2.0)*t1_d*t3_d - 0.007736652973*pow(c4, 2.0)*pow(s2, 3.0)*pow(t3, 2.0)*t1_d*t2_d - 0.007736652973*pow(s2, 3.0)*pow(s4, 2.0)*pow(t3, 2.0)*t1_d*t2_d + 0.003125937017*c2*pow(c4, 2.0)*s2*t1_d*t2_d - 0.0000000004701665536*c2*pow(c4, 2.0)*s2*t1_d*t3_d + 0.000000001148839953*c2*pow(c4, 2.0)*s2*t1_d*t4_d + 0.000000001148839953*pow(c2, 2.0)*c4*s4*t1_d*t2_d - 0.0000000007072965002*pow(c2, 2.0)*c4*s4*t1_d*t4_d + 0.02989213166*c2*pow(c4, 2.0)*t3*t2_d*t3_d + 0.00312593959*c2*s2*pow(s4, 2.0)*t1_d*t2_d - 0.0000000004701665536*c2*s2*pow(s4, 2.0)*t1_d*t3_d - 0.000000001148839953*c2*s2*pow(s4, 2.0)*t1_d*t4_d - 0.000000001148839953*c4*pow(s2, 2.0)*s4*t1_d*t2_d + 0.000000001866025403*c4*pow(s2, 2.0)*s4*t1_d*t4_d + 0.2080961238*c2*s2*pow(t3, 2.0)*t1_d*t2_d + 0.000008321632637*c2*pow(s2, 2.0)*t3*t1_d*t2_d - 0.0003575275713*pow(c2, 2.0)*s2*t3*t1_d*t2_d + 0.08712770474*c2*pow(s2, 2.0)*t3*t1_d*t3_d + 0.02989213166*c2*pow(s4, 2.0)*t3*t2_d*t3_d - 0.007736652973*pow(c2, 2.0)*pow(c4, 2.0)*s2*pow(t3, 2.0)*t1_d*t2_d + 0.005306714589*pow(c2, 2.0)*pow(c4, 2.0)*pow(s2, 2.0)*t3*t1_d*t3_d - 0.007736652973*pow(c2, 2.0)*s2*pow(s4, 2.0)*pow(t3, 2.0)*t1_d*t2_d + 0.005306714589*pow(c2, 2.0)*pow(s2, 2.0)*pow(s4, 2.0)*t3*t1_d*t3_d - 0.01967172393*c2*pow(c4, 2.0)*s2*t3*t1_d*t2_d - 0.01967172393*c2*s2*pow(s4, 2.0)*t3*t1_d*t2_d + 0.03695649964*c2*pow(c4, 2.0)*s2*pow(t3, 2.0)*t1_d*t2_d + 9.84269479e-11*c2*pow(c4, 2.0)*pow(s2, 2.0)*t3*t1_d*t2_d + 0.004118090172*pow(c2, 2.0)*pow(c4, 2.0)*s2*t3*t1_d*t2_d + 0.01547330595*c2*pow(c4, 2.0)*pow(s2, 2.0)*t3*t1_d*t3_d + 0.03695649964*c2*s2*pow(s4, 2.0)*pow(t3, 2.0)*t1_d*t2_d + 9.84269479e-11*c2*pow(s2, 2.0)*pow(s4, 2.0)*t3*t1_d*t2_d + 0.004118090172*pow(c2, 2.0)*s2*pow(s4, 2.0)*t3*t1_d*t2_d + 0.01547330595*c2*pow(s2, 2.0)*pow(s4, 2.0)*t3*t1_d*t3_d + 5.196154522e-12*c2*c4*s2*s4*t1_d*t2_d - 4.639567174e-12*c2*c4*s2*s4*t1_d*t4_d;

	double r2_1 =0.005125892675*pow(c2, 2.0)*pow(c4, 2.0)*pow(t3, 2.0) - 0.002728482042*pow(c2, 2.0)*pow(c4, 2.0)*t3 + 0.0003630886719*pow(c2, 2.0)*pow(c4, 2.0) + 0.005125892675*pow(c2, 2.0)*pow(s4, 2.0)*pow(t3, 2.0) - 0.002728482042*pow(c2, 2.0)*pow(s4, 2.0)*t3 + 0.0003630886719*pow(c2, 2.0)*pow(s4, 2.0) + 0.02886307975*pow(c2, 2.0)*pow(t3, 2.0) - 0.0008759504883*pow(c2, 2.0)*t3 + 0.002292124758*pow(c2, 2.0) + 0.01494606583*c2*pow(c4, 2.0)*pow(t3, 2.0) - 0.007955539304*c2*pow(c4, 2.0)*t3 + 0.001264159028*c2*pow(c4, 2.0) - 9.462498894e-13*c2*c4*s4 + 6.855943054e-13*c2*c4 + 0.01494606583*c2*pow(s4, 2.0)*pow(t3, 2.0) - 0.007955539304*c2*pow(s4, 2.0)*t3 + 0.00126415856*c2*pow(s4, 2.0) - 1.206017627e-11*c2*s4 + 0.08415890019*c2*pow(t3, 2.0) + 0.0006906902294*c2*t3 + 0.0141794312*c2 + 0.005125892675*pow(c4, 2.0)*pow(s2, 2.0)*pow(t3, 2.0) - 0.002728482042*pow(c4, 2.0)*pow(s2, 2.0)*t3 + 0.0003630886719*pow(c4, 2.0)*pow(s2, 2.0) + 0.000000000190146262*pow(c4, 2.0)*s2*t3 - 4.983759492e-11*pow(c4, 2.0)*s2 + 0.00007048126535*pow(c4, 2.0) + 0.0000000007611599381*c4*s2*s4 - 3.069166558e-11*c4*s2 - 3.245252249e-13*c4*s4 - 7.367983131e-13*c4 + 0.005125892675*pow(s2, 2.0)*pow(s4, 2.0)*pow(t3, 2.0) - 0.002728482042*pow(s2, 2.0)*pow(s4, 2.0)*t3 + 0.0003630886719*pow(s2, 2.0)*pow(s4, 2.0) + 0.02886307975*pow(s2, 2.0)*pow(t3, 2.0) - 0.0008759504883*pow(s2, 2.0)*t3 + 0.002292124758*pow(s2, 2.0) + 0.000000000190146262*s2*pow(s4, 2.0)*t3 - 5.137455952e-11*s2*pow(s4, 2.0) - 1.744753175e-12*s2*s4 + 0.00001607615976*s2*t3 + 0.0003766704703*s2 + 0.00007048110464*pow(s4, 2.0) + 1.296089671e-11*s4 + 0.001424943683;
	double r2_2 =0.01980492847*pow(c4, 2.0)*pow(t3, 2.0) - 0.01054204508*pow(c4, 2.0)*t3 + 0.001675185599*pow(c4, 2.0) - 1.253869184e-12*c4*s4 - 2.846770078e-12*c4 + 0.01980492847*pow(s4, 2.0)*pow(t3, 2.0) - 0.01054204508*pow(s4, 2.0)*t3 + 0.001675184978*pow(s4, 2.0) + 5.007705946e-11*s4 + 0.1115183766*pow(t3, 2.0) - 0.003384412797*t3 + 0.01436164962;
	double r2_3 =0.00002130266008;
	double r2_4 =2.31196051e-12*c4 - 4.066931379e-11*s4 - 0.00000024536634;
	double e2_left =0.002818179178*pow(s2, 3.0)*pow(t1_d, 2.0) - 0.0003124408552*pow(s2, 2.0)*pow(t1_d, 2.0) + 0.4166445498*c1*c2 + 0.01227093936*c1*s2 + 0.003175952808*c2*s1 - 0.1078355445*s1*s2 - 0.003384412797*t2_d*t3_d - 0.00002998694014*c2*pow(t1_d, 2.0) - 4.066931379e-11*c4*pow(t4_d, 2.0) + 0.0008517276657*s2*pow(t1_d, 2.0) - 2.31196051e-12*s4*pow(t4_d, 2.0) + 0.0003124408552*pow(c2, 2.0)*pow(t1_d, 2.0) - 0.0000675025513*pow(c2, 3.0)*pow(t1_d, 2.0) - 0.0131832796*c2*s2*pow(t1_d, 2.0) + 4.515753854e-13*c2*s4*pow(t1_d, 2.0) + 1.774448635e-13*c4*s2*pow(t1_d, 2.0) - 0.0008759504883*pow(c2, 2.0)*t1_d*t3_d - 3.245252249e-13*pow(c4, 2.0)*t1_d*t4_d - 0.01054204508*pow(c4, 2.0)*t2_d*t3_d - 1.253869184e-12*pow(c4, 2.0)*t2_d*t4_d - 3.121403306e-12*s2*s4*pow(t1_d, 2.0) - 0.0008759504883*pow(s2, 2.0)*t1_d*t3_d + 3.245252249e-13*pow(s4, 2.0)*t1_d*t4_d - 0.01054204508*pow(s4, 2.0)*t2_d*t3_d + 1.253869184e-12*pow(s4, 2.0)*t2_d*t4_d - 1.988978543e-13*c2*pow(c4, 2.0)*pow(t1_d, 2.0) - 3.794498635e-11*pow(c2, 2.0)*c4*pow(t1_d, 2.0) - 0.0000675025513*c2*pow(s2, 2.0)*pow(t1_d, 2.0) + 0.002818179178*pow(c2, 2.0)*s2*pow(t1_d, 2.0) + 1.988978543e-13*c2*pow(s4, 2.0)*pow(t1_d, 2.0) + 3.794498635e-11*c4*pow(s2, 2.0)*pow(t1_d, 2.0) - 2.157088602e-12*pow(c2, 2.0)*s4*pow(t1_d, 2.0) + 0.00005318967112*pow(c4, 2.0)*s2*pow(t1_d, 2.0) + 0.00001987541736*pow(c2, 2.0)*t3*pow(t1_d, 2.0) - 0.000004160816319*pow(c2, 3.0)*t3*pow(t1_d, 2.0) + 0.00005318954984*s2*pow(s4, 2.0)*pow(t1_d, 2.0) + 2.157088602e-12*pow(s2, 2.0)*s4*pow(t1_d, 2.0) - 0.00001987541736*pow(s2, 2.0)*t3*pow(t1_d, 2.0) + 0.0001787637856*pow(s2, 3.0)*t3*pow(t1_d, 2.0) + 1.634852846*c1*c2*t3 - 0.00255425661*c2*t1_d*t3_d + 1.296089671e-11*c4*t1_d*t4_d + 5.007705946e-11*c4*t2_d*t4_d - 6.314569048e-11*pow(c2, 2.0)*pow(c4, 2.0)*pow(t1_d, 2.0) + 1.309781658e-11*pow(c2, 3.0)*pow(c4, 2.0)*pow(t1_d, 2.0) - 0.4231310524*s1*s2*t3 + 0.00003215250967*s2*t1_d*t3_d + 0.000000303353443*s2*t1_d*t4_d + 7.367983131e-13*s4*t1_d*t4_d + 2.846770078e-12*s4*t2_d*t4_d + 0.2230367532*t3*t2_d*t3_d - 6.198579868e-11*pow(c2, 2.0)*pow(s4, 2.0)*pow(t1_d, 2.0) + 6.314569048e-11*pow(c4, 2.0)*pow(s2, 2.0)*pow(t1_d, 2.0) + 1.309781658e-11*pow(c2, 3.0)*pow(s4, 2.0)*pow(t1_d, 2.0) + 0.0002739987614*pow(c4, 2.0)*pow(s2, 3.0)*pow(t1_d, 2.0) + 6.198579868e-11*pow(s2, 2.0)*pow(s4, 2.0)*pow(t1_d, 2.0) + 0.0002739987614*pow(s2, 3.0)*pow(s4, 2.0)*pow(t1_d, 2.0) + 0.02178192619*pow(s2, 3.0)*pow(t3, 2.0)*pow(t1_d, 2.0) + 7.943587577e-12*c2*c4*pow(t1_d, 2.0) - 6.191170476e-11*c2*c4*t1_d*t4_d - 3.519543406e-12*c2*s4*t1_d*t4_d - 0.0000000003214330391*c4*s4*t1_d*t4_d - 0.000000001241921895*c4*s4*t2_d*t4_d + 0.1683178004*c2*t3*t1_d*t3_d + 1.309781658e-11*c2*pow(c4, 2.0)*pow(s2, 2.0)*pow(t1_d, 2.0) + 0.0002739987614*pow(c2, 2.0)*pow(c4, 2.0)*s2*pow(t1_d, 2.0) + 0.0000000002350832768*pow(c2, 2.0)*pow(c4, 2.0)*t3*pow(t1_d, 2.0) - 4.921347395e-11*pow(c2, 3.0)*pow(c4, 2.0)*t3*pow(t1_d, 2.0) + 1.309781658e-11*c2*pow(s2, 2.0)*pow(s4, 2.0)*pow(t1_d, 2.0) + 0.0002739987614*pow(c2, 2.0)*s2*pow(s4, 2.0)*pow(t1_d, 2.0) + 0.02178192619*pow(c2, 2.0)*s2*pow(t3, 2.0)*pow(t1_d, 2.0) + 0.0000000002350832768*pow(c2, 2.0)*pow(s4, 2.0)*t3*pow(t1_d, 2.0) - 0.0000000002350832768*pow(c4, 2.0)*pow(s2, 2.0)*t3*pow(t1_d, 2.0) - 4.921347395e-11*pow(c2, 3.0)*pow(s4, 2.0)*t3*pow(t1_d, 2.0) - 0.002059045086*pow(c4, 2.0)*pow(s2, 3.0)*t3*pow(t1_d, 2.0) - 0.0000000002350832768*pow(s2, 2.0)*pow(s4, 2.0)*t3*pow(t1_d, 2.0) - 0.002059045086*pow(s2, 3.0)*pow(s4, 2.0)*t3*pow(t1_d, 2.0) + 2.656072907e-12*c2*c4*s2*pow(t1_d, 2.0) - 0.0000000001970026884*c2*c4*s4*pow(t1_d, 2.0) - 0.007955539304*c2*pow(c4, 2.0)*t1_d*t3_d - 9.462498894e-13*c2*pow(c4, 2.0)*t1_d*t4_d - 4.672253255e-11*c2*s2*s4*pow(t1_d, 2.0) - 2.449074928e-13*c4*s2*s4*pow(t1_d, 2.0) + 0.003157700128*c2*s2*t3*pow(t1_d, 2.0) - 0.007955539304*c2*pow(s4, 2.0)*t1_d*t3_d + 0.000000000190146262*pow(c4, 2.0)*s2*t1_d*t3_d + 9.462498894e-13*c2*pow(s4, 2.0)*t1_d*t4_d + 0.0000000007611599381*pow(c4, 2.0)*s2*t1_d*t4_d + 0.05772615949*pow(c2, 2.0)*t3*t1_d*t3_d + 0.03960985694*pow(c4, 2.0)*t3*t2_d*t3_d + 0.000000000190146262*s2*pow(s4, 2.0)*t1_d*t3_d - 0.0000000007611599381*s2*pow(s4, 2.0)*t1_d*t4_d + 0.05772615949*pow(s2, 2.0)*t3*t1_d*t3_d + 0.03960985694*pow(s4, 2.0)*t3*t2_d*t3_d + 0.003868326487*pow(c4, 2.0)*pow(s2, 3.0)*pow(t3, 2.0)*pow(t1_d, 2.0) + 0.003868326487*pow(s2, 3.0)*pow(s4, 2.0)*pow(t3, 2.0)*pow(t1_d, 2.0) - 0.001562968508*c2*pow(c4, 2.0)*s2*pow(t1_d, 2.0) - 0.0000000005744199764*pow(c2, 2.0)*c4*s4*pow(t1_d, 2.0) - 0.002728482042*pow(c2, 2.0)*pow(c4, 2.0)*t1_d*t3_d - 0.001562969795*c2*s2*pow(s4, 2.0)*pow(t1_d, 2.0) + 0.0000000005744199764*c4*pow(s2, 2.0)*s4*pow(t1_d, 2.0) - 0.1040480619*c2*s2*pow(t3, 2.0)*pow(t1_d, 2.0) - 0.000004160816319*c2*pow(s2, 2.0)*t3*pow(t1_d, 2.0) + 0.0001787637856*pow(c2, 2.0)*s2*t3*pow(t1_d, 2.0) - 0.002728482042*pow(c2, 2.0)*pow(s4, 2.0)*t1_d*t3_d - 0.002728482042*pow(c4, 2.0)*pow(s2, 2.0)*t1_d*t3_d - 0.002728482042*pow(s2, 2.0)*pow(s4, 2.0)*t1_d*t3_d + 0.003868326487*pow(c2, 2.0)*s2*pow(s4, 2.0)*pow(t3, 2.0)*pow(t1_d, 2.0) + 0.009835861967*c2*pow(c4, 2.0)*s2*t3*pow(t1_d, 2.0) + 0.01025178535*pow(c2, 2.0)*pow(c4, 2.0)*t3*t1_d*t3_d + 0.009835861967*c2*s2*pow(s4, 2.0)*t3*pow(t1_d, 2.0) + 0.01025178535*pow(c2, 2.0)*pow(s4, 2.0)*t3*t1_d*t3_d + 0.01025178535*pow(c4, 2.0)*pow(s2, 2.0)*t3*t1_d*t3_d + 0.01025178535*pow(s2, 2.0)*pow(s4, 2.0)*t3*t1_d*t3_d - 0.0000000009372337008*c2*c4*s4*t1_d*t4_d - 3.073929188e-12*c4*s2*s4*t1_d*t4_d - 0.01847824982*c2*pow(c4, 2.0)*s2*pow(t3, 2.0)*pow(t1_d, 2.0) - 4.921347395e-11*c2*pow(c4, 2.0)*pow(s2, 2.0)*t3*pow(t1_d, 2.0) - 0.002059045086*pow(c2, 2.0)*pow(c4, 2.0)*s2*t3*pow(t1_d, 2.0) - 0.01847824982*c2*s2*pow(s4, 2.0)*pow(t3, 2.0)*pow(t1_d, 2.0) - 4.921347395e-11*c2*pow(s2, 2.0)*pow(s4, 2.0)*t3*pow(t1_d, 2.0) - 0.002059045086*pow(c2, 2.0)*s2*pow(s4, 2.0)*t3*pow(t1_d, 2.0) - 2.598077261e-12*c2*c4*s2*s4*pow(t1_d, 2.0) + 0.02989213166*c2*pow(c4, 2.0)*t3*t1_d*t3_d + 0.02989213166*c2*pow(s4, 2.0)*t3*t1_d*t3_d + 0.003868326487*pow(c2, 2.0)*pow(c4, 2.0)*s2*pow(t3, 2.0)*pow(t1_d, 2.0);

	double r3_1 =0.000005513534141*pow(c2, 2.0) + 0.00001607634991*c2 + 0.000005513534141*pow(s2, 2.0) + 0.003244946839*s2;
	double r3_2 =0.00002130266008;
	double r3_3 =0.211484;
	double r3_4 =0.0;
	double e3_left =1.23376453*s1 + 0.00009386954291*pow(s2, 2.0)*pow(t1_d, 2.0) - 0.000004160816319*pow(s2, 3.0)*pow(t1_d, 2.0) + 0.0001133563345*pow(s2, 4.0)*pow(t1_d, 2.0) + 0.005271022542*pow(s4, 2.0)*pow(t2_d, 2.0) + 1.634852846*c1*s2 + 0.4231310524*c2*s1 - 0.1115183766*t3*pow(t2_d, 2.0) + 0.001692206398*pow(t2_d, 2.0) - 0.001484980521*pow(c2, 2.0)*pow(t1_d, 2.0) - 0.0001787637856*pow(c2, 3.0)*pow(t1_d, 2.0) + 0.0001133563345*pow(c2, 4.0)*pow(t1_d, 2.0) + 0.005271022542*pow(c4, 2.0)*pow(t2_d, 2.0) + 0.00001987541736*c2*s2*pow(t1_d, 2.0) + 0.0008759504883*pow(c2, 2.0)*t1_d*t2_d + 0.0008759504883*pow(s2, 2.0)*t1_d*t2_d - 0.0001787637856*c2*pow(s2, 2.0)*pow(t1_d, 2.0) - 0.000004160816319*pow(c2, 2.0)*s2*pow(t1_d, 2.0) - 0.06351168926*pow(c2, 2.0)*t3*pow(t1_d, 2.0) - 0.04356385237*pow(c2, 3.0)*t3*pow(t1_d, 2.0) - 0.007470314739*pow(c2, 4.0)*t3*pow(t1_d, 2.0) - 0.01980492847*pow(c4, 2.0)*t3*pow(t2_d, 2.0) - 0.1675597511*pow(s2, 2.0)*t3*pow(t1_d, 2.0) - 0.007470314739*pow(s2, 4.0)*t3*pow(t1_d, 2.0) - 0.01980492847*pow(s4, 2.0)*t3*pow(t2_d, 2.0) + 0.00255425661*c2*t1_d*t2_d + 0.0030018182*pow(c2, 2.0)*pow(c4, 2.0)*pow(t1_d, 2.0) + 0.002059045086*pow(c2, 3.0)*pow(c4, 2.0)*pow(t1_d, 2.0) + 0.0003530915583*pow(c2, 4.0)*pow(c4, 2.0)*pow(t1_d, 2.0) - 0.00003215250967*s2*t1_d*t2_d + 0.0002267126689*pow(c2, 2.0)*pow(s2, 2.0)*pow(t1_d, 2.0) + 0.0030018182*pow(c2, 2.0)*pow(s4, 2.0)*pow(t1_d, 2.0) + 0.007919749183*pow(c4, 2.0)*pow(s2, 2.0)*pow(t1_d, 2.0) + 0.002059045086*pow(c2, 3.0)*pow(s4, 2.0)*pow(t1_d, 2.0) - 4.921347395e-11*pow(c4, 2.0)*pow(s2, 3.0)*pow(t1_d, 2.0) + 0.0003530915583*pow(c2, 4.0)*pow(s4, 2.0)*pow(t1_d, 2.0) + 0.0003530915583*pow(c4, 2.0)*pow(s2, 4.0)*pow(t1_d, 2.0) + 0.007919749183*pow(s2, 2.0)*pow(s4, 2.0)*pow(t1_d, 2.0) - 4.921347395e-11*pow(s2, 3.0)*pow(s4, 2.0)*pow(t1_d, 2.0) + 0.0003530915583*pow(s2, 4.0)*pow(s4, 2.0)*pow(t1_d, 2.0) - 0.1683178004*c2*t3*t1_d*t2_d + 0.002059045086*c2*pow(c4, 2.0)*pow(s2, 2.0)*pow(t1_d, 2.0) - 4.921347395e-11*pow(c2, 2.0)*pow(c4, 2.0)*s2*pow(t1_d, 2.0) - 0.01127925729*pow(c2, 2.0)*pow(c4, 2.0)*t3*pow(t1_d, 2.0) - 0.007736652973*pow(c2, 3.0)*pow(c4, 2.0)*t3*pow(t1_d, 2.0) - 0.001326678647*pow(c2, 4.0)*pow(c4, 2.0)*t3*pow(t1_d, 2.0) + 0.002059045086*c2*pow(s2, 2.0)*pow(s4, 2.0)*pow(t1_d, 2.0) - 4.921347395e-11*pow(c2, 2.0)*s2*pow(s4, 2.0)*pow(t1_d, 2.0) - 0.01494062948*pow(c2, 2.0)*pow(s2, 2.0)*t3*pow(t1_d, 2.0) - 0.01127925729*pow(c2, 2.0)*pow(s4, 2.0)*t3*pow(t1_d, 2.0) - 0.02975750711*pow(c4, 2.0)*pow(s2, 2.0)*t3*pow(t1_d, 2.0) - 0.007736652973*pow(c2, 3.0)*pow(s4, 2.0)*t3*pow(t1_d, 2.0) - 0.001326678647*pow(c2, 4.0)*pow(s4, 2.0)*t3*pow(t1_d, 2.0) - 0.001326678647*pow(c4, 2.0)*pow(s2, 4.0)*t3*pow(t1_d, 2.0) - 0.02975750711*pow(s2, 2.0)*pow(s4, 2.0)*t3*pow(t1_d, 2.0) - 0.001326678647*pow(s2, 4.0)*pow(s4, 2.0)*t3*pow(t1_d, 2.0) + 0.007955539304*c2*pow(c4, 2.0)*t1_d*t2_d + 0.007955539304*c2*pow(s4, 2.0)*t1_d*t2_d - 0.000000000190146262*pow(c4, 2.0)*s2*t1_d*t2_d - 0.05772615949*pow(c2, 2.0)*t3*t1_d*t2_d + 0.0007061831167*pow(c2, 2.0)*pow(c4, 2.0)*pow(s2, 2.0)*pow(t1_d, 2.0) - 0.000000000190146262*s2*pow(s4, 2.0)*t1_d*t2_d - 0.05772615949*pow(s2, 2.0)*t3*t1_d*t2_d + 0.0007061831167*pow(c2, 2.0)*pow(s2, 2.0)*pow(s4, 2.0)*pow(t1_d, 2.0) + 0.0000000002350832768*c2*pow(c4, 2.0)*s2*pow(t1_d, 2.0) + 0.002728482042*pow(c2, 2.0)*pow(c4, 2.0)*t1_d*t2_d + 0.0000000002350832768*c2*s2*pow(s4, 2.0)*pow(t1_d, 2.0) - 0.04356385237*c2*pow(s2, 2.0)*t3*pow(t1_d, 2.0) + 0.002728482042*pow(c2, 2.0)*pow(s4, 2.0)*t1_d*t2_d + 0.002728482042*pow(c4, 2.0)*pow(s2, 2.0)*t1_d*t2_d + 0.002728482042*pow(s2, 2.0)*pow(s4, 2.0)*t1_d*t2_d - 0.002653357295*pow(c2, 2.0)*pow(s2, 2.0)*pow(s4, 2.0)*t3*pow(t1_d, 2.0) - 0.01025178535*pow(c2, 2.0)*pow(c4, 2.0)*t3*t1_d*t2_d - 0.01025178535*pow(c2, 2.0)*pow(s4, 2.0)*t3*t1_d*t2_d - 0.01025178535*pow(c4, 2.0)*pow(s2, 2.0)*t3*t1_d*t2_d - 0.01025178535*pow(s2, 2.0)*pow(s4, 2.0)*t3*t1_d*t2_d - 0.007736652973*c2*pow(c4, 2.0)*pow(s2, 2.0)*t3*pow(t1_d, 2.0) - 0.007736652973*c2*pow(s2, 2.0)*pow(s4, 2.0)*t3*pow(t1_d, 2.0) - 0.02989213166*c2*pow(c4, 2.0)*t3*t1_d*t2_d - 0.02989213166*c2*pow(s4, 2.0)*t3*t1_d*t2_d - 0.002653357295*pow(c2, 2.0)*pow(c4, 2.0)*pow(s2, 2.0)*t3*pow(t1_d, 2.0);

	double r4_1 =0.000000303353443*c2 + 5.983794116e-13*c4 - 1.052599296e-11*s4 + 1.744753284e-12*c2*c4 - 3.069166558e-11*c2*s4 + 4.985152849e-11*c4*s2 + 2.8339491e-12*s2*s4 - 0.00000006350548183;
	double r4_2 =2.31196051e-12*c4 - 4.066931379e-11*s4 - 0.00000024536634;
	double r4_3 =0.0;
	double r4_4 =0.000000398541;
	double e4_left =3.570503464e-13*pow(c2, 2.0)*pow(c4, 2.0)*pow(t1_d, 2.0) + 0.0000000003536482501*pow(c2, 2.0)*c4*s4*pow(t1_d, 2.0) + 2.336126628e-11*pow(c2, 2.0)*c4*pow(t1_d, 2.0) - 3.570503464e-13*pow(c2, 2.0)*pow(s4, 2.0)*pow(t1_d, 2.0) + 1.328036289e-12*pow(c2, 2.0)*s4*pow(t1_d, 2.0) - 0.0000000005744199764*c2*pow(c4, 2.0)*s2*pow(t1_d, 2.0) + 2.449074928e-13*c2*pow(c4, 2.0)*pow(t1_d, 2.0) + 9.462498894e-13*c2*pow(c4, 2.0)*t1_d*t2_d + 2.319783587e-12*c2*c4*s2*s4*pow(t1_d, 2.0) - 2.157088602e-12*c2*c4*s2*pow(t1_d, 2.0) + 0.0000000002425739316*c2*c4*s4*pow(t1_d, 2.0) + 0.0000000009372337008*c2*c4*s4*t1_d*t2_d + 3.121403306e-12*c2*c4*pow(t1_d, 2.0) + 6.191170476e-11*c2*c4*t1_d*t2_d + 0.0000000005744199764*c2*s2*pow(s4, 2.0)*pow(t1_d, 2.0) + 3.794498635e-11*c2*s2*s4*pow(t1_d, 2.0) - 2.449074928e-13*c2*pow(s4, 2.0)*pow(t1_d, 2.0) - 9.462498894e-13*c2*pow(s4, 2.0)*t1_d*t2_d + 1.774448635e-13*c2*s4*pow(t1_d, 2.0) + 3.519543406e-12*c2*s4*t1_d*t2_d - 9.419882841e-13*pow(c4, 2.0)*pow(s2, 2.0)*pow(t1_d, 2.0) - 0.0000000001970026884*pow(c4, 2.0)*s2*pow(t1_d, 2.0) - 0.0000000007611599381*pow(c4, 2.0)*s2*t1_d*t2_d + 4.199665442e-14*pow(c4, 2.0)*pow(t1_d, 2.0) + 3.245252249e-13*pow(c4, 2.0)*t1_d*t2_d + 6.269345921e-13*pow(c4, 2.0)*pow(t2_d, 2.0) - 0.0000000009330127016*c4*pow(s2, 2.0)*s4*pow(t1_d, 2.0) + 7.955914171e-13*c4*s2*s4*pow(t1_d, 2.0) + 3.073929188e-12*c4*s2*s4*t1_d*t2_d + 4.515753854e-13*c4*s2*pow(t1_d, 2.0) + 4.159649613e-11*c4*s4*pow(t1_d, 2.0) + 0.0000000003214330391*c4*s4*t1_d*t2_d + 0.0000000006209609476*c4*s4*pow(t2_d, 2.0) - 1.677263455e-12*c4*pow(t1_d, 2.0) - 1.296089671e-11*c4*t1_d*t2_d - 2.503852973e-11*c4*pow(t2_d, 2.0) + 9.419882841e-13*pow(s2, 2.0)*pow(s4, 2.0)*pow(t1_d, 2.0) + 0.0000000001970026884*s2*pow(s4, 2.0)*pow(t1_d, 2.0) + 0.0000000007611599381*s2*pow(s4, 2.0)*t1_d*t2_d - 7.943587577e-12*s2*s4*pow(t1_d, 2.0) - 0.000000303353443*s2*t1_d*t2_d - 4.199665442e-14*pow(s4, 2.0)*pow(t1_d, 2.0) - 3.245252249e-13*pow(s4, 2.0)*t1_d*t2_d - 6.269345921e-13*pow(s4, 2.0)*pow(t2_d, 2.0) - 9.534871792e-14*s4*pow(t1_d, 2.0) - 7.367983131e-13*s4*t1_d*t2_d - 1.423385039e-12*s4*pow(t2_d, 2.0);

	Array2D<double> left_terms(4,1);
	left_terms[0][0]=e1_left;
	left_terms[1][0]=e2_left;
	left_terms[2][0]=e3_left;
	left_terms[3][0]=e4_left;

	Array2D<double> M(4,4);
	M[0][0]=r1_1;
	M[0][1]=r1_2;
	M[0][2]=r1_3;
	M[0][3]=r1_4;

	M[1][0]=r2_1;
	M[1][1]=r2_2;
	M[1][2]=r2_3;
	M[1][3]=r2_4;

	M[2][0]=r3_1;
	M[2][1]=r3_2;
	M[2][2]=r3_3;
	M[2][3]=r3_4;

	M[3][0]=r4_1;
	M[3][1]=r4_2;
	M[3][2]=r4_3;
	M[3][3]=r4_4;

	Array2D<double> right_side(4,1),dd(4,1);
	right_side=PID_control_green(r,t)-left_terms;

	dd= matmult(inverse(M),right_side);

	drdt[4] = dd[0][0];
	drdt[5] = dd[1][0];
	drdt[6] = dd[2][0];
	drdt[7] = dd[3][0];
}
